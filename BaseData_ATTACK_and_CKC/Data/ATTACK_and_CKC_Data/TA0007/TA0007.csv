tactic_id,tactic_name_jp,tactic_name_eng,tactic_description_jp,tactic_description_eng,technique_id,technique_name_jp,technique_name_eng,technique_description_jp,technique_description_eng,subtechnique_id,subtechnique_name_jp,subtechnique_name_eng,subtechnique_description_jp,subtechnique_description_eng,cyber_kill_chain_phase_number_1,cyber_kill_chain_phase_name_eng_1,cyber_kill_chain_phase_description_eng_1,cyber_kill_chain_phase_name_jp_1,cyber_kill_chain_phase_description_jp_1,cyber_kill_chain_phase_number_2,cyber_kill_chain_phase_name_eng_2,cyber_kill_chain_phase_description_eng_2,cyber_kill_chain_phase_name_jp_2,cyber_kill_chain_phase_description_jp_2,tactic_ckc_mapping_rational
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1033,システム所有者/ユーザーの探索,System Owner/User Discovery,"攻撃者は、主要ユーザー、現在ログインしているユーザー、システムを一般的に使用するユーザーのセット、またはユーザーがシステムをアクティブに使用しているかどうかを特定しようとする可能性があります。例えば、アカウントのユーザー名を取得したり、[OS資格情報ダンピング](https://attack.mitre.org/techniques/T1003)を使用したりすることによってこれを行う可能性があります。ユーザーとユーザー名の詳細はシステム全体に存在し、実行中のプロセスの所有権、ファイル/ディレクトリの所有権、セッション情報、システムログが含まれるため、情報は他のディスカバリーテクニックを使用してさまざまな方法で収集される可能性があります。攻撃者は、自動検出中に[システム所有者/ユーザーディスカバリー](https://attack.mitre.org/techniques/T1033)からの情報を使用して、攻撃者がターゲットを完全に感染させるかどうか、および/または特定のアクションを試みるかどうかなど、その後の動作を形成する可能性があります。

<code>whoami</code>など、さまざまなユーティリティやコマンドがこの情報を取得する可能性があります。macOSおよびLinuxでは、現在ログインしているユーザーは<code>w</code>および<code>who</code>で識別できます。macOSでは、<code>dscl . list /Users | grep -v '_'</code>コマンドを使用してユーザーアカウントを列挙することもできます。<code>%USERNAME%</code>や<code>$USER</code>などの環境変数も、この情報にアクセスするために使用される場合があります。

ネットワークデバイスでは、<code>show users</code>や<code>show ssh</code>などの[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)コマンドを使用して、現在デバイスにログインしているユーザーを表示できます。(引用: show_ssh_users_cmd_cisco)(引用: US-CERT TA18-106A Network Infrastructure Devices 2018)","Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Various utilities and commands may acquire this information, including <code>whoami</code>. In macOS and Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>. On macOS the <code>dscl . list /Users | grep -v '_'</code> command can also be used to enumerate user accounts. Environment variables, such as <code>%USERNAME%</code> and <code>$USER</code>, may also be used to access this information.

On network devices, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `show users` and `show ssh` can be used to display users currently logged into the device.(Citation: show_ssh_users_cmd_cisco)(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1613,コンテナとリソースの探索,Container and Resource Discovery,"攻撃者は、コンテナ環境内で利用可能なコンテナやその他のリソースを発見しようとする可能性があります。その他のリソースには、イメージ、デプロイメント、ポッド、ノード、およびクラスターのステータスなどのその他の情報が含まれる場合があります。

これらのリソースは、KubernetesダッシュボードなどのWebアプリケーション内で表示したり、DockerおよびKubernetes APIを介してクエリしたりできます。(引用: Docker API)(引用: Kubernetes API) Dockerでは、ログから環境の構成、利用可能なサービス、被害者が利用している可能性のあるクラウドプロバイダーなどの環境に関する情報が漏洩する可能性があります。これらのリソースの発見は、横方向の移動を実行する方法や実行に使用するメソッドなど、環境内での攻撃者の次のステップを通知する可能性があります。","Adversaries may attempt to discover containers and other resources that are available within a containers environment. Other resources may include images, deployments, pods, nodes, and other information such as the status of a cluster.

These resources can be viewed within web applications such as the Kubernetes dashboard or can be queried via the Docker and Kubernetes APIs.(Citation: Docker API)(Citation: Kubernetes API) In Docker, logs may leak information about the environment, such as the environment’s configuration, which services are available, and what cloud provider the victim may be utilizing. The discovery of these resources may inform an adversary’s next steps in the environment, such as how to perform lateral movement and which methods to utilize for execution.",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1069,権限グループの探索,Permission Groups Discovery,"攻撃者はグループと権限設定を発見しようとする可能性があります。この情報は、攻撃者が利用可能なユーザーアカウントとグループ、特定のグループのユーザーのメンバーシップ、および昇格された権限を持つユーザーとグループを特定するのに役立ちます。

攻撃者は多くの異なる方法でグループ権限設定を発見しようとする可能性があります。このデータは、その後の活動やターゲティングで使用できる侵害された環境に関する情報を攻撃者に提供する可能性があります。(引用: CrowdStrike BloodHound April 2018)","Adversaries may attempt to discover group and permission settings. This information can help adversaries determine which user accounts and groups are available, the membership of users in particular groups, and which users and groups have elevated permissions.

Adversaries may attempt to discover group permission settings in many different ways. This data may provide the adversary with information about the compromised environment that can be used in follow-on activity and targeting.(Citation: CrowdStrike BloodHound April 2018)",T1069.003,クラウドグループ,Cloud Groups,"攻撃者はクラウドグループと権限設定を見つけようとする可能性があります。クラウド権限グループの知識は、攻撃者が環境内のユーザーとグループの特定の役割、および特定のグループに関連付けられているユーザーを特定するのに役立ちます。

認証済みアクセスがあれば、権限グループを見つけるために使用できるいくつかのツールがあります。<code>Get-MsolRole</code> PowerShellコマンドレットを使用して、ExchangeおよびOffice 365アカウントの役割と権限グループを取得できます。(引用: Microsoft Msolrole)(引用: GitHub Raindance)

Azure CLI (AZ CLI) および Google Cloud Identity Provider API も、権限グループを取得するためのインターフェイスを提供します。コマンド <code>az ad user get-member-groups</code> は Azure のユーザーアカウントに関連付けられたグループをリストし、API エンドポイント <code>GET https://cloudidentity.googleapis.com/v1/groups</code> は Google のユーザーが利用可能なグループリソースをリストします。(引用: Microsoft AZ CLI)(引用: Black Hills Red Teaming MS AD Azure, 2018)(引用: Google Cloud Identity API Documentation) AWSでは、<code>ListRolePolicies</code>および<code>ListAttachedRolePolicies</code>コマンドにより、ユーザーはロールにアタッチされたポリシーを列挙できます。(引用: Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022)

敵対者は、オブジェクトの所有者やオブジェクトへのアクセス権を持つ他のアカウントを特定するために、例えばAWSの<code>GetBucketAcl</code> APIを介してオブジェクトのACLをリストしようとするかもしれない。(引用：AWS Get Bucket ACL) この情報を使用して、敵対者は特定のオブジェクトへのアクセス権を持つアカウントを標的にしたり、既に侵害したアカウントを利用してオブジェクトにアクセスしたりすることができる。","Adversaries may attempt to find cloud groups and permission settings. The knowledge of cloud permission groups can help adversaries determine the particular roles of users and groups within an environment, as well as which users are associated with a particular group.

With authenticated access there are several tools that can be used to find permissions groups. The <code>Get-MsolRole</code> PowerShell cmdlet can be used to obtain roles and permissions groups for Exchange and Office 365 accounts (Citation: Microsoft Msolrole)(Citation: GitHub Raindance).

Azure CLI (AZ CLI) and the Google Cloud Identity Provider API also provide interfaces to obtain permissions groups. The command <code>az ad user get-member-groups</code> will list groups associated to a user account for Azure while the API endpoint <code>GET https://cloudidentity.googleapis.com/v1/groups</code> lists group resources available to a user for Google.(Citation: Microsoft AZ CLI)(Citation: Black Hills Red Teaming MS AD Azure, 2018)(Citation: Google Cloud Identity API Documentation) In AWS, the commands `ListRolePolicies` and `ListAttachedRolePolicies` allow users to enumerate the policies attached to a role.(Citation: Palo Alto Unit 42 Compromised Cloud Compute Credentials 2022)

Adversaries may attempt to list ACLs for objects to determine the owner and other accounts with access to the object, for example, via the AWS <code>GetBucketAcl</code> API (Citation: AWS Get Bucket ACL). Using this information an adversary can target accounts with permissions to a given object or leverage accounts they have already compromised to access the object.",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1069,権限グループの探索,Permission Groups Discovery,"攻撃者はグループと権限設定を発見しようとする可能性があります。この情報は、攻撃者が利用可能なユーザーアカウントとグループ、特定のグループのユーザーのメンバーシップ、および昇格された権限を持つユーザーとグループを特定するのに役立ちます。

攻撃者は多くの異なる方法でグループ権限設定を発見しようとする可能性があります。このデータは、その後の活動やターゲティングで使用できる侵害された環境に関する情報を攻撃者に提供する可能性があります。(引用: CrowdStrike BloodHound April 2018)","Adversaries may attempt to discover group and permission settings. This information can help adversaries determine which user accounts and groups are available, the membership of users in particular groups, and which users and groups have elevated permissions.

Adversaries may attempt to discover group permission settings in many different ways. This data may provide the adversary with information about the compromised environment that can be used in follow-on activity and targeting.(Citation: CrowdStrike BloodHound April 2018)",T1069.002,ドメイングループ,Domain Groups,"攻撃者はドメインレベルのグループと権限設定を見つけようとする可能性があります。ドメインレベルの権限グループの知識は、攻撃者がどのグループが存在し、どのユーザーが特定のグループに属しているかを特定するのに役立ちます。攻撃者はこの情報を使用して、ドメイン管理者など、昇格された権限を持つユーザーを特定する可能性があります。

[Net](https://attack.mitre.org/software/S0039)ユーティリティの<code>net group /domain</code>、macOSの<code>dscacheutil -q group</code>、Linuxの<code>ldapsearch</code>などのコマンドで、ドメインレベルのグループを一覧表示できます。","Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.

Commands such as <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility,  <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain-level groups.",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1069,権限グループの探索,Permission Groups Discovery,"攻撃者はグループと権限設定を発見しようとする可能性があります。この情報は、攻撃者が利用可能なユーザーアカウントとグループ、特定のグループのユーザーのメンバーシップ、および昇格された権限を持つユーザーとグループを特定するのに役立ちます。

攻撃者は多くの異なる方法でグループ権限設定を発見しようとする可能性があります。このデータは、その後の活動やターゲティングで使用できる侵害された環境に関する情報を攻撃者に提供する可能性があります。(引用: CrowdStrike BloodHound April 2018)","Adversaries may attempt to discover group and permission settings. This information can help adversaries determine which user accounts and groups are available, the membership of users in particular groups, and which users and groups have elevated permissions.

Adversaries may attempt to discover group permission settings in many different ways. This data may provide the adversary with information about the compromised environment that can be used in follow-on activity and targeting.(Citation: CrowdStrike BloodHound April 2018)",T1069.001,ローカルグループ,Local Groups,"攻撃者はローカルシステムグループと権限設定を見つけようとする可能性があります。ローカルシステム権限グループの知識は、攻撃者がどのグループが存在し、どのユーザーが特定のグループに属しているかを特定するのに役立ちます。攻撃者はこの情報を使用して、ローカル管理者グループ内に見つかったユーザーなど、昇格された権限を持つユーザーを特定する可能性があります。

[Net](https://attack.mitre.org/software/S0039)ユーティリティの<code>net localgroup</code>、macOSの<code>dscl . -list /Groups</code>、Linuxの<code>groups</code>などのコマンドでローカルグループを一覧表示できます。","Adversaries may attempt to find local system groups and permission settings. The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group.

Commands such as <code>net localgroup</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscl . -list /Groups</code> on macOS, and <code>groups</code> on Linux can list local groups.",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1615,グループポリシーの探索,Group Policy Discovery,"攻撃者は、権限昇格の経路、ドメイン内で適用されるセキュリティ対策を特定し、操作または環境に溶け込むために使用できるドメインオブジェクトのパターンを発見するために、グループポリシー設定に関する情報を収集する可能性があります。グループポリシーにより、Active Directory（AD）のユーザーとコンピューターの設定を一元管理できます。グループポリシーオブジェクト（GPO）は、予測可能なネットワークパス<code>\\<DOMAIN>\\SYSVOL\\<DOMAIN>\\Policies\\</code>内に保存されているファイルで構成されるグループポリシー設定のコンテナーです。(引用: TechNet Group Policy Basics)(引用: ADSecurity GPO Persistence 2016)

攻撃者は、<code>gpresult</code>などのコマンドや、<code>Get-DomainGPO</code>や<code>Get-DomainGPOLocalGroup</code>などのさまざまな一般に入手可能なPowerShell関数を使用して、グループポリシー設定に関する情報を収集する可能性があります。(引用: Microsoft gpresult)(引用: Github PowerShell Empire) 攻撃者はこの情報を使用して、ターゲットネットワーク内の潜在的な攻撃パスや、利益のためにグループポリシー設定を操作する機会（つまり、[ドメインまたはテナントポリシーの変更](https://attack.mitre.org/techniques/T1484)）を決定するなど、その後の行動を形成する可能性があります。","Adversaries may gather information on Group Policy settings to identify paths for privilege escalation, security measures applied within a domain, and to discover patterns in domain objects that can be manipulated or used to blend in the environment. Group Policy allows for centralized management of user and computer settings in Active Directory (AD). Group policy objects (GPOs) are containers for group policy settings made up of files stored within a predictable network path `\\<DOMAIN>\\SYSVOL\\<DOMAIN>\\Policies\\`.(Citation: TechNet Group Policy Basics)(Citation: ADSecurity GPO Persistence 2016)

Adversaries may use commands such as <code>gpresult</code> or various publicly available PowerShell functions, such as <code>Get-DomainGPO</code> and <code>Get-DomainGPOLocalGroup</code>, to gather information on Group Policy settings.(Citation: Microsoft gpresult)(Citation: Github PowerShell Empire) Adversaries may use this information to shape follow-on behaviors, including determining potential attack paths within the target network as well as opportunities to manipulate Group Policy settings (i.e. [Domain or Tenant Policy Modification](https://attack.mitre.org/techniques/T1484)) for their benefit.",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1652,デバイスドライバーの探索,Device Driver Discovery,"攻撃者は、被害者ホスト上のローカルデバイスドライバーを列挙しようとする可能性があります。デバイスドライバーに関する情報は、ホストの機能/目的、存在するセキュリティツール（つまり、[セキュリティソフトウェアの発見](https://attack.mitre.org/techniques/T1518/001)）またはその他の防御（例えば、[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)）、および潜在的な悪用可能な脆弱性（例えば、[権限昇格のための悪用](https://attack.mitre.org/techniques/T1068)）など、その後の行動を形成するさまざまな洞察を明らかにする可能性があります。

多くのOSユーティリティは、Windows上の`driverquery.exe`や`EnumDeviceDrivers()` API関数など、ローカルデバイスドライバに関する情報を提供できます。(引用: Microsoft Driverquery)(引用: Microsoft EnumDeviceDrivers) デバイスドライバに関する情報（および関連サービス、つまり[システムサービスディスカバリ](https://attack.mitre.org/techniques/T1007)）は、レジストリでも利用できる場合があります。(引用: Microsoft Registry Drivers)

Linux/macOSでは、デバイスドライバ（カーネルモジュールの形式）は`/dev`内、または`lsmod`や`modinfo`などのユーティリティを使用して表示される場合があります。(引用: Linux Kernel Programming)(引用: lsmod man)(引用: modinfo man)","Adversaries may attempt to enumerate local device drivers on a victim host. Information about device drivers may highlight various insights that shape follow-on behaviors, such as the function/purpose of the host, present security tools (i.e. [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001)) or other defenses (e.g., [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497)), as well as potential exploitable vulnerabilities (e.g., [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)).

Many OS utilities may provide information about local device drivers, such as `driverquery.exe` and the `EnumDeviceDrivers()` API function on Windows.(Citation: Microsoft Driverquery)(Citation: Microsoft EnumDeviceDrivers) Information about device drivers (as well as associated services, i.e., [System Service Discovery](https://attack.mitre.org/techniques/T1007)) may also be available in the Registry.(Citation: Microsoft Registry Drivers)

On Linux/macOS, device drivers (in the form of kernel modules) may be visible within `/dev` or using utilities such as `lsmod` and `modinfo`.(Citation: Linux Kernel Programming)(Citation: lsmod man)(Citation: modinfo man)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1007,システムサービスの探索,System Service Discovery,"攻撃者は、登録されているローカルシステムサービスに関する情報を収集しようとする可能性があります。攻撃者は、<code>sc query</code>、<code>tasklist /svc</code>、<code>systemctl --type=service</code>、<code>net start</code>などのOSユーティリティコマンドやツールを使用してサービスに関する情報を取得する可能性があります。

攻撃者は、自動検出中に[システムサービスディスカバリ](https://attack.mitre.org/techniques/T1007)からの情報を使用して、攻撃者がターゲットを完全に感染させるかどうか、および/または特定のアクションを試みるかどうかなど、その後の行動を形成する可能性があります。","Adversaries may try to gather information about registered local system services. Adversaries may obtain information about services using tools as well as OS utility commands such as <code>sc query</code>, <code>tasklist /svc</code>, <code>systemctl --type=service</code>, and <code>net start</code>.

Adversaries may use the information from [System Service Discovery](https://attack.mitre.org/techniques/T1007) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1040,ネットワークスニッフィング,Network Sniffing,"攻撃者は、ネットワーク経由で渡される認証マテリアルを含む、環境に関する情報をキャプチャするために、ネットワークトラフィックを受動的にスニッフィングする可能性があります。ネットワークスニッフィングとは、システム上のネットワークインターフェイスを使用して、有線または無線接続を介して送信される情報を監視またはキャプチャすることを指します。攻撃者は、ネットワークインターフェイスを無差別モードにしてネットワーク経由で送信中のデータに受動的にアクセスしたり、SPANポートを使用してより大量のデータをキャプチャしたりする可能性があります。

このテクニックでキャプチャされたデータには、ユーザー資格情報、特に安全でない暗号化されていないプロトコルで送信されたものが含まれる場合があります。[LLMNR/NBT-NSポイズニングとSMBリレー](https://attack.mitre.org/techniques/T1557/001)などの名前サービス解決ポイズニングのテクニックも、トラフィックを攻撃者にリダイレクトすることにより、ウェブサイト、プロキシ、および内部システムの資格情報をキャプチャするために使用できます。

ネットワークスニッフィングは、実行中のサービス、バージョン番号、およびその後の[ラテラルムーブメント](https://attack.mitre.org/tactics/TA0008)および/または[防御回避](https://attack.mitre.org/tactics/TA0005)アクティビティに必要なその他のネットワーク特性（IPアドレス、ホスト名、VLAN IDなど）などの構成の詳細を明らかにする可能性があります。攻撃者はまた、[中間者攻撃](https://attack.mitre.org/techniques/T1557)（AiTM）中にネットワークスニッフィングを利用して、環境に関する追加の知識を受動的に得る可能性があります。

クラウドベースの環境では、攻撃者は依然としてトラフィックミラーリングサービスを使用して仮想マシンからネットワークトラフィックをスニッフィングできる可能性があります。例えば、AWS Traffic Mirroring、GCP Packet Mirroring、Azure vTapにより、ユーザーはトラフィックを収集する特定のインスタンスと、収集されたトラフィックを送信する特定のターゲットを定義できます。(引用: AWS Traffic Mirroring)(引用: GCP Packet Mirroring)(引用: Azure Virtual Network TAP) 多くの場合、このトラフィックの多くは、トラフィックの暗号化と復号化の負担を軽減するためにロードバランサーレベルでTLS終端を使用するため、平文になります。(引用: Rhino Security Labs AWS VPC Traffic Mirroring)(引用: SpecterOps AWS Traffic Mirroring) その後、攻撃者は、スニッフィングされたトラフィックにアクセスするために、クラウドアカウントへのデータ転送などの持ち出しテクニックを使用できます。(引用: Rhino Security Labs AWS VPC Traffic Mirroring)

ネットワークデバイスでは、攻撃者は<code>monitor capture</code>などの[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)コマンドを使用してネットワークキャプチャを実行する可能性があります。(引用: US-CERT-TA18-106A)(引用: capture_embedded_packet_on_software)","Adversaries may passively sniff network traffic to capture information about an environment, including authentication material passed over the network. Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.

Data captured via this technique may include user credentials, especially those sent over an insecure, unencrypted protocol. Techniques for name service resolution poisoning, such as [LLMNR/NBT-NS Poisoning and SMB Relay](https://attack.mitre.org/techniques/T1557/001), can also be used to capture credentials to websites, proxies, and internal systems by redirecting traffic to an adversary.

Network sniffing may reveal configuration details, such as running services, version numbers, and other network characteristics (e.g. IP addresses, hostnames, VLAN IDs) necessary for subsequent [Lateral Movement](https://attack.mitre.org/tactics/TA0008) and/or [Defense Evasion](https://attack.mitre.org/tactics/TA0005) activities. Adversaries may likely also utilize network sniffing during [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) (AiTM) to passively gain additional knowledge about the environment.

In cloud-based environments, adversaries may still be able to use traffic mirroring services to sniff network traffic from virtual machines. For example, AWS Traffic Mirroring, GCP Packet Mirroring, and Azure vTap allow users to define specified instances to collect traffic from and specified targets to send collected traffic to.(Citation: AWS Traffic Mirroring)(Citation: GCP Packet Mirroring)(Citation: Azure Virtual Network TAP) Often, much of this traffic will be in cleartext due to the use of TLS termination at the load balancer level to reduce the strain of encrypting and decrypting traffic.(Citation: Rhino Security Labs AWS VPC Traffic Mirroring)(Citation: SpecterOps AWS Traffic Mirroring) The adversary can then use exfiltration techniques such as Transfer Data to Cloud Account in order to access the sniffed traffic.(Citation: Rhino Security Labs AWS VPC Traffic Mirroring)

On network devices, adversaries may perform network captures using [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `monitor capture`.(Citation: US-CERT-TA18-106A)(Citation: capture_embedded_packet_on_software)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1135,ネットワーク共有の探索,Network Share Discovery,"攻撃者は、収集の前段階として収集する情報源を特定したり、横方向の移動に関心のある潜在的なシステムを特定したりする手段として、リモートシステムで共有されているフォルダやドライブを探す可能性があります。ネットワークには、ユーザーがネットワーク全体のさまざまなシステム上のファイルディレクトリにアクセスできるようにする共有ネットワークドライブやフォルダが含まれていることがよくあります。

Windowsネットワーク経由のファイル共有は、SMBプロトコル経由で行われます。(引用: Wikipedia Shared Resource)(引用: TechNet Shared Folder) [Net](https://attack.mitre.org/software/S0039)を使用して、<code>net view \\\\\\\\remotesystem</code>コマンドでリモートシステム上の利用可能な共有ドライブを照会できます。また、<code>net share</code>を使用してローカルシステム上の共有ドライブを照会することもできます。macOSの場合、<code>sharing -l</code>コマンドはsmbサービスに使用されるすべての共有ポイントを一覧表示します。","Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement. Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network.

File sharing over a Windows network occurs over the SMB protocol. (Citation: Wikipedia Shared Resource) (Citation: TechNet Shared Folder) [Net](https://attack.mitre.org/software/S0039) can be used to query a remote system for available shared drives using the <code>net view \\\\\\\\remotesystem</code> command. It can also be used to query shared drives on the local system using <code>net share</code>. For macOS, the <code>sharing -l</code> command lists all shared points used for smb services.",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1120,周辺機器の探索,Peripheral Device Discovery,攻撃者は、コンピュータシステムに接続されている接続済み周辺機器およびコンポーネントに関する情報を収集しようとする可能性があります。(引用: Peripheral Discovery Linux)(引用: Peripheral Discovery macOS) 周辺機器には、キーボード、プリンタ、カメラ、スマートカードリーダー、リムーバブルストレージなど、さまざまな機能をサポートする補助リソースが含まれる場合があります。この情報は、システムおよびネットワーク環境の認識を高めるために使用されたり、さらなるアクションのために使用されたりする可能性があります。,"Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system.(Citation: Peripheral Discovery Linux)(Citation: Peripheral Discovery macOS) Peripheral devices could include auxiliary resources that support a variety of functionalities such as keyboards, printers, cameras, smart card readers, or removable storage. The information may be used to enhance their awareness of the system and network environment or may be used for further actions.",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1082,システム情報の探索,System Information Discovery,"攻撃者は、バージョン、パッチ、ホットフィックス、サービスパック、アーキテクチャなど、オペレーティングシステムとハードウェアに関する詳細情報を取得しようとする可能性があります。攻撃者は、自動検出中に[システム情報ディスカバリ](https://attack.mitre.org/techniques/T1082)からの情報を使用して、攻撃者がターゲットを完全に感染させるかどうか、および/または特定のアクションを試みるかどうかなど、その後の行動を形成する可能性があります。

[Systeminfo](https://attack.mitre.org/software/S0096)などのツールを使用して、詳細なシステム情報を収集できます。特権アクセスで実行している場合、macOSの<code>systemsetup</code>構成ツールを介してシステムデータの詳細を取得できます。ユーザーレベルのアクセス権を持つ攻撃者は、<code>df -aH</code>コマンドを実行して、現在マウントされているディスクと関連する空き領域を取得できます。攻撃者はまた、ネットワークデバイス上の[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)を利用して、詳細なシステム情報を収集する（例：<code>show version</code>）可能性があります。(引用: US-CERT-TA18-106A) ESXiサーバーでは、脅威アクターは<code>system hostname get</code>、<code>system version get</code>、<code>storage filesystem list</code>（ストレージボリュームを一覧表示するため）など、さまざまなesxcliユーティリティからシステム情報を収集する可能性があります。(引用: Crowdstrike Hypervisor Jackpotting Pt 2 2021)(引用: Varonis)

AWS、GCP、AzureなどのInfrastructure as a Service（IaaS）クラウドプロバイダーは、APIを介してインスタンスおよび仮想マシン情報へのアクセスを許可します。認証されたAPI呼び出しが成功すると、特定のインスタンスのオペレーティングシステムプラットフォームやステータス、または仮想マシンのモデルビューなどのデータが返される可能性があります。(引用: Amazon Describe Instance)(引用: Google Instances Resource)(引用: Microsoft Virutal Machine API)

[システム情報ディスカバリ](https://attack.mitre.org/techniques/T1082)と、他の形式のディスカバリおよび偵察から収集された情報を組み合わせることで、ペイロードの開発と隠蔽を促進できます。(引用: OSX.FairyTale)(引用: 20 macOS Common Tools and Techniques)","An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from [System Information Discovery](https://attack.mitre.org/techniques/T1082) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Tools such as [Systeminfo](https://attack.mitre.org/software/S0096) can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the <code>systemsetup</code> configuration tool on macOS. As an example, adversaries with user-level access can execute the <code>df -aH</code> command to obtain currently mounted disks and associated freely available space. Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather detailed system information (e.g. <code>show version</code>).(Citation: US-CERT-TA18-106A) On ESXi servers, threat actors may gather system information from various esxcli utilities, such as `system hostname get`, `system version get`, and `storage filesystem list` (to list storage volumes).(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)(Citation: Varonis)

Infrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs. Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine.(Citation: Amazon Describe Instance)(Citation: Google Instances Resource)(Citation: Microsoft Virutal Machine API)

[System Information Discovery](https://attack.mitre.org/techniques/T1082) combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.(Citation: OSX.FairyTale)(Citation: 20 macOS Common Tools and Techniques)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1010,アプリケーションウィンドウの探索,Application Window Discovery,"攻撃者は、開いているアプリケーションウィンドウのリストを取得しようとする可能性があります。ウィンドウリストは、システムの利用方法に関する情報を伝える可能性があります。(引用: Prevailion DarkWatchman 2021) 例えば、アプリケーションウィンドウに関する情報は、収集する潜在的なデータを特定したり、回避するセキュリティツール（[セキュリティソフトウェアの発見](https://attack.mitre.org/techniques/T1518/001)）を特定したりするために使用される可能性があります。(引用: ESET Grandoreiro April 2020)

敵対者は通常、この種の列挙のためにシステム機能を利用します。例えば、[コマンドおよびスクリプトインタープリタ](https://attack.mitre.org/techniques/T1059)コマンドや[ネイティブAPI](https://attack.mitre.org/techniques/T1106)関数などのネイティブシステム機能を介して情報を収集する場合があります。","Adversaries may attempt to get a listing of open application windows. Window listings could convey information about how the system is used.(Citation: Prevailion DarkWatchman 2021) For example, information about application windows could be used identify potential data to collect as well as identifying security tooling ([Security Software Discovery](https://attack.mitre.org/techniques/T1518/001)) to evade.(Citation: ESET Grandoreiro April 2020)

Adversaries typically abuse system features for this type of enumeration. For example, they may gather information through native system features such as [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059) commands and [Native API](https://attack.mitre.org/techniques/T1106) functions.",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1580,クラウドインフラストラクチャの探索,Cloud Infrastructure Discovery,"攻撃者は、Infrastructure-as-a-Service（IaaS）環境内で利用可能なインフラストラクチャとリソースを発見しようとする可能性があります。これには、インスタンス、仮想マシン、スナップショットなどのコンピューティングサービスリソースや、ストレージおよびデータベースサービスを含む他のサービスのリソースが含まれます。

クラウドプロバイダーは、APIやCLI経由で発行されるコマンドなど、インフラストラクチャに関する情報を提供する方法を提供しています。例えば、AWSはAmazon EC2 API内に<code>DescribeInstances</code> APIを提供しており、これによりアカウント内の1つ以上のインスタンスに関する情報、リクエストの認証済み送信者が所有するすべてのバケットのリストを返す<code>ListBuckets</code> API、バケットの存在とリクエスト送信者のアクセス権限を判断するための<code>HeadBucket</code> API、またはバケットのアクセスブロック構成を取得するための<code>GetPublicAccessBlock</code> APIを返すことができます。(引用: Amazon Describe Instance)(引用: Amazon Describe Instances API)(引用: AWS Get Public Access Block)(引用: AWS Head Bucket) 同様に、GCPのCloud SDK CLIは<code>gcloud compute instances list</code>コマンドを提供してプロジェクト内のすべてのGoogle Compute Engineインスタンスを一覧表示し(引用: Google Compute Instances)、AzureのCLIコマンド<code>az vm list</code>は仮想マシンの詳細を一覧表示します。(引用: Microsoft AZ CLI) APIコマンドに加えて、攻撃者は[ワードリストスキャン](https://attack.mitre.org/techniques/T1595/003)を介してクラウドストレージインフラストラクチャを発見するためにオープンソースツールを利用する可能性があります。(引用: Malwarebytes OSINT Leaky Buckets - Hioureas)

攻撃者は、侵害されたユーザーのアクセスキーを使用してリソースを列挙し、そのユーザーが利用できるリソースを特定する可能性があります。(引用: Expel IO Evil in AWS) これらの利用可能なリソースの発見は、永続性の確立など、クラウド環境での次のステップを決定するのに役立つ可能性があります。(引用: Mandiant M-Trends 2020)攻撃者はまた、この情報を使用して構成を変更し、バケットをパブリックにアクセスできるようにし、認証なしでデータにアクセスできるようにする可能性もあります。攻撃者はまた、データベースリソースのサイズ、所有者、権限、ネットワークACLを特定するために、<code>DescribeDBInstances</code>などのインフラストラクチャ検出APIを使用しています。(引用: AWS Describe DB Instances) 攻撃者はこの情報を使用して、データベースの潜在的な価値を判断し、それらにアクセスするための要件を発見できます。[クラウドサービスディスカバリ](https://attack.mitre.org/techniques/T1526)とは異なり、このテクニックはサービス自体ではなく、提供されるサービスのコンポーネントの発見に焦点を当てています。","An adversary may attempt to discover infrastructure and resources that are available within an infrastructure-as-a-service (IaaS) environment. This includes compute service resources such as instances, virtual machines, and snapshots as well as resources of other services including the storage and database services.

Cloud providers offer methods such as APIs and commands issued through CLIs to serve information about infrastructure. For example, AWS provides a <code>DescribeInstances</code> API within the Amazon EC2 API that can return information about one or more instances within an account, the <code>ListBuckets</code> API that returns a list of all buckets owned by the authenticated sender of the request, the <code>HeadBucket</code> API to determine a bucket’s existence along with access permissions of the request sender, or the <code>GetPublicAccessBlock</code> API to retrieve access block configuration for a bucket.(Citation: Amazon Describe Instance)(Citation: Amazon Describe Instances API)(Citation: AWS Get Public Access Block)(Citation: AWS Head Bucket) Similarly, GCP's Cloud SDK CLI provides the <code>gcloud compute instances list</code> command to list all Google Compute Engine instances in a project (Citation: Google Compute Instances), and Azure's CLI command <code>az vm list</code> lists details of virtual machines.(Citation: Microsoft AZ CLI) In addition to API commands, adversaries can utilize open source tools to discover cloud storage infrastructure through [Wordlist Scanning](https://attack.mitre.org/techniques/T1595/003).(Citation: Malwarebytes OSINT Leaky Buckets - Hioureas)

An adversary may enumerate resources using a compromised user's access keys to determine which are available to that user.(Citation: Expel IO Evil in AWS) The discovery of these available resources may help adversaries determine their next steps in the Cloud environment, such as establishing Persistence.(Citation: Mandiant M-Trends 2020)An adversary may also use this information to change the configuration to make the bucket publicly accessible, allowing data to be accessed without authentication. Adversaries have also may use infrastructure discovery APIs such as <code>DescribeDBInstances</code> to determine size, owner, permissions, and network ACLs of database resources. (Citation: AWS Describe DB Instances) Adversaries can use this information to determine the potential value of databases and discover the requirements to access them. Unlike in [Cloud Service Discovery](https://attack.mitre.org/techniques/T1526), this technique focuses on the discovery of components of the provided services rather than the services themselves.",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1217,ブラウザ情報の探索,Browser Information Discovery,"攻撃者は、侵害された環境についてさらに学ぶためにブラウザに関する情報を列挙する可能性があります。ブラウザによって保存されたデータ（ブックマーク、アカウント、閲覧履歴など）は、ユーザーに関するさまざまな個人情報（銀行サイト、関係/興味、ソーシャルメディアなど）や、サーバー、ツール/ダッシュボード、またはその他の関連インフラストラクチャなどの内部ネットワークリソースに関する詳細を明らかにする可能性があります。(引用: Kaspersky Autofill)

ブラウザ情報はまた、攻撃者が有効な資格情報、特にブラウザによってキャッシュされたログインに関連する[ファイル内の資格情報](https://attack.mitre.org/techniques/T1552/001)へのアクセスを取得した後、追加のターゲットを浮き彫りにする可能性があります。

特定のストレージ場所はプラットフォームやアプリケーションによって異なりますが、ブラウザ情報は通常、ローカルファイルやデータベース（例：`%APPDATA%/Google/Chrome`）に保存されます。(引用: Chrome Roaming Profiles)","Adversaries may enumerate information about browsers to learn more about compromised environments. Data saved by browsers (such as bookmarks, accounts, and browsing history) may reveal a variety of personal information about users (e.g., banking sites, relationships/interests, social media, etc.) as well as details about internal network resources such as servers, tools/dashboards, or other related infrastructure.(Citation: Kaspersky Autofill)

Browser information may also highlight additional targets after an adversary has access to valid credentials, especially [Credentials In Files](https://attack.mitre.org/techniques/T1552/001) associated with logins cached by a browser.

Specific storage locations vary based on platform and/or application, but browser information is typically stored in local files and databases (e.g., `%APPDATA%/Google/Chrome`).(Citation: Chrome Roaming Profiles)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1673,仮想マシンの探索,Virtual Machine Discovery,"攻撃者は、ホストまたはハイパーバイザーへのアクセスを取得した後、実行中の仮想マシン（VM）を列挙しようとする可能性があります。例えば、攻撃者は<code>esxcli</code>や<code>vim-cmd</code>（例：<code>esxcli vm process list</code>または<code>vim-cmd vmsvc/getallvms</code>）などの[ハイパーバイザーCLI](https://attack.mitre.org/techniques/T1059/012)を使用してESXiハイパーバイザー上のVMのリストを列挙する可能性があります。(引用: Crowdstrike Hypervisor Jackpotting Pt 2 2021)(引用: TrendMicro Play) 攻撃者はまた、VMware vCenterなどのグラフィカルユーザーインターフェイスを直接利用して、ホスト上の仮想マシンを表示する可能性もあります。

攻撃者は、[仮想マシンディスカバリ](https://attack.mitre.org/techniques/T1673)からの情報をディスカバリ中に使用して、その後の行動を形成する可能性があります。その後発見されたVMは、[サービス停止](https://attack.mitre.org/techniques/T1489)や[影響のためのデータ暗号化](https://attack.mitre.org/techniques/T1486)などの追跡活動に利用される可能性があります。(引用: Crowdstrike Hypervisor Jackpotting Pt 2 2021)","An adversary may attempt to enumerate running virtual machines (VMs) after gaining access to a host or hypervisor. For example, adversaries may enumerate a list of VMs on an ESXi hypervisor using a [Hypervisor CLI](https://attack.mitre.org/techniques/T1059/012) such as `esxcli` or `vim-cmd` (e.g. `esxcli vm process list or vim-cmd vmsvc/getallvms`).(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)(Citation: TrendMicro Play) Adversaries may also directly leverage a graphical user interface, such as VMware vCenter, in order to view virtual machines on a host.

Adversaries may use the information from [Virtual Machine Discovery](https://attack.mitre.org/techniques/T1673) during discovery to shape follow-on behaviors. Subsequently discovered VMs may be leveraged for follow-on activities such as [Service Stop](https://attack.mitre.org/techniques/T1489) or [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486).(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1016,システムネットワーク構成の探索,System Network Configuration Discovery,"攻撃者は、アクセスしたシステムのIPアドレスやMACアドレスなどのネットワーク構成と設定に関する詳細、またはリモートシステムの情報の発見を通じて情報を探す可能性があります。この情報を収集するために使用できるオペレーティングシステムの管理ユーティリティがいくつか存在します。例としては、[Arp](https://attack.mitre.org/software/S0099)、[ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101)、[nbtstat](https://attack.mitre.org/software/S0102)、[route](https://attack.mitre.org/software/S0103)などがあります。

敵対者はまた、ネットワークデバイス上の[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)を利用して、構成済みインターフェイスのIPアドレスや静的/動的ルートなどの構成や設定に関する情報を収集する（例：<code>show ip route</code>、<code>show ip interface</code>）。(引用: US-CERT-TA18-106A)(引用: Mandiant APT41 Global Intrusion ) ESXiでは、敵対者はesxcliを利用してネットワーク構成情報を収集する。例えば、コマンド<code>esxcli network nic list</code>はMACアドレスを取得し、<code>esxcli network ip interface ipv4 get</code>はローカルIPv4アドレスを取得する。(引用：Trellix Rnasomhouse 2024）

攻撃者は、自動検出中に[システムネットワーク構成ディスカバリ](https://attack.mitre.org/techniques/T1016)からの情報を使用して、ターゲットネットワーク内の特定のアクセスや次に実行するアクションの決定など、その後の行動を形成する可能性があります。","Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103).

Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather information about configurations and settings, such as IP addresses of configured interfaces and static/dynamic routes (e.g. <code>show ip route</code>, <code>show ip interface</code>).(Citation: US-CERT-TA18-106A)(Citation: Mandiant APT41 Global Intrusion ) On ESXi, adversaries may leverage esxcli to gather network configuration information. For example, the command `esxcli network nic list` will retrieve the MAC address, while `esxcli network ip interface ipv4 get` will retrieve the local IPv4 address.(Citation: Trellix Rnasomhouse 2024)

Adversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next.",T1016.002,Wi-Fi探索,Wi-Fi Discovery,"攻撃者は、侵害されたシステム上のネットワーク名やパスワードなどのWi-Fiネットワークに関する情報を検索する可能性があります。攻撃者は、進行中および将来のキャンペーンをサポートするために、[アカウントディスカバリ](https://attack.mitre.org/techniques/T1087)、[リモートシステムディスカバリ](https://attack.mitre.org/techniques/T1018)、およびその他のディスカバリまたは[認証情報アクセス](https://attack.mitre.org/tactics/TA0006)アクティビティの一環としてWi-Fi情報を使用する可能性があります。

敵対者はホストからWi-Fiネットワークに関する様々な種類の情報を収集するかもしれない。例えば、Windowsでは、デバイスが以前に接続したすべてのWi-Fiネットワークの名前とパスワードは、<code>netsh wlan show profiles</code>でWi-Fi名を列挙し、その後<code>netsh wlan show profile “Wi-Fi name” key=clear</code>でWi-Fiネットワークの対応するパスワードを表示することで利用可能になるかもしれない。(引用：BleepingComputer Agent Tesla steal wifi passwords)(引用：Malware Bytes New AgentTesla variant steals WiFi credentials)(引用：Check Point APT35 CharmPower January 2022) さらに、ローカルで到達可能なWi-Fiネットワークの名前やその他の詳細は、<code>wlanAPI.dll</code> [ネイティブAPI](https://attack.mitre.org/techniques/T1106)関数への呼び出しを使用して発見できる。(引用：Binary Defense Emotes Wi-Fi Spreader)

Linuxでは、デバイスが以前に接続したすべてのWi-Fiネットワークの名前とパスワードは、<code>/etc/NetworkManager/system-connections/</code>以下のファイルで利用できる場合があります。(引用: Wi-Fi Password of All Connected Networks in Windows/Linux) macOSでは、既知のWi-Fiのパスワードは<code>security find-generic-password -wa wifiname</code>で識別できます（管理者ユーザー名/パスワードが必要）。(引用: Find Wi-Fi Password on Mac)","Adversaries may search for information about Wi-Fi networks, such as network names and passwords, on compromised systems. Adversaries may use Wi-Fi information as part of [Account Discovery](https://attack.mitre.org/techniques/T1087), [Remote System Discovery](https://attack.mitre.org/techniques/T1018), and other discovery or [Credential Access](https://attack.mitre.org/tactics/TA0006) activity to support both ongoing and future campaigns.

Adversaries may collect various types of information about Wi-Fi networks from hosts. For example, on Windows names and passwords of all Wi-Fi networks a device has previously connected to may be available through `netsh wlan show profiles` to enumerate Wi-Fi names and then `netsh wlan show profile “Wi-Fi name” key=clear` to show a Wi-Fi network’s corresponding password.(Citation: BleepingComputer Agent Tesla steal wifi passwords)(Citation: Malware Bytes New AgentTesla variant steals WiFi credentials)(Citation: Check Point APT35 CharmPower January 2022) Additionally, names and other details of locally reachable Wi-Fi networks can be discovered using calls to `wlanAPI.dll` [Native API](https://attack.mitre.org/techniques/T1106) functions.(Citation: Binary Defense Emotes Wi-Fi Spreader)

On Linux, names and passwords of all Wi-Fi-networks a device has previously connected to may be available in files under ` /etc/NetworkManager/system-connections/`.(Citation: Wi-Fi Password of All Connected Networks in Windows/Linux) On macOS, the password of a known Wi-Fi may be identified with ` security find-generic-password -wa wifiname` (requires admin username/password).(Citation: Find Wi-Fi Password on Mac)",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1016,システムネットワーク構成の探索,System Network Configuration Discovery,"攻撃者は、アクセスしたシステムのIPアドレスやMACアドレスなどのネットワーク構成と設定に関する詳細、またはリモートシステムの情報の発見を通じて情報を探す可能性があります。この情報を収集するために使用できるオペレーティングシステムの管理ユーティリティがいくつか存在します。例としては、[Arp](https://attack.mitre.org/software/S0099)、[ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101)、[nbtstat](https://attack.mitre.org/software/S0102)、[route](https://attack.mitre.org/software/S0103)などがあります。

敵対者はまた、ネットワークデバイス上の[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)を利用して、構成済みインターフェイスのIPアドレスや静的/動的ルートなどの構成や設定に関する情報を収集する（例：<code>show ip route</code>、<code>show ip interface</code>）。(引用: US-CERT-TA18-106A)(引用: Mandiant APT41 Global Intrusion ) ESXiでは、敵対者はesxcliを利用してネットワーク構成情報を収集する。例えば、コマンド<code>esxcli network nic list</code>はMACアドレスを取得し、<code>esxcli network ip interface ipv4 get</code>はローカルIPv4アドレスを取得する。(引用：Trellix Rnasomhouse 2024）

攻撃者は、自動検出中に[システムネットワーク構成ディスカバリ](https://attack.mitre.org/techniques/T1016)からの情報を使用して、ターゲットネットワーク内の特定のアクセスや次に実行するアクションの決定など、その後の行動を形成する可能性があります。","Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103).

Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather information about configurations and settings, such as IP addresses of configured interfaces and static/dynamic routes (e.g. <code>show ip route</code>, <code>show ip interface</code>).(Citation: US-CERT-TA18-106A)(Citation: Mandiant APT41 Global Intrusion ) On ESXi, adversaries may leverage esxcli to gather network configuration information. For example, the command `esxcli network nic list` will retrieve the MAC address, while `esxcli network ip interface ipv4 get` will retrieve the local IPv4 address.(Citation: Trellix Rnasomhouse 2024)

Adversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next.",T1016.001,インターネット接続の探索,Internet Connection Discovery,"攻撃者は、侵害されたシステムでインターネット接続を確認する可能性があります。これは自動検出中に実行される可能性があり、[Ping](https://attack.mitre.org/software/S0097)、<code>tracert</code>、WebサイトへのGETリクエストなど、さまざまな方法で実行できます。

攻撃者は、これらのリクエストからの結果と応答を使用して、C2サーバーへの接続を試みる前にシステムがC2サーバーと通信できるかどうかを判断する場合があります。結果は、ルート、リダイレクタ、プロキシサーバーを特定するためにも使用される場合があります。","Adversaries may check for Internet connectivity on compromised systems. This may be performed during automated discovery and can be accomplished in numerous ways such as using [Ping](https://attack.mitre.org/software/S0097), <code>tracert</code>, and GET requests to websites.

Adversaries may use the results and responses from these requests to determine if the system is capable of communicating with their C2 servers before attempting to connect to them. The results may also be used to identify routes, redirectors, and proxy servers.",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1087,アカウントの探索,Account Discovery,"攻撃者は、システム上または侵害された環境内で有効なアカウント、ユーザー名、またはメールアドレスのリストを取得しようとする可能性があります。この情報は、攻撃者がどのアカウントが存在するかを判断するのに役立ち、ブルートフォース攻撃、スピアフィッシング攻撃、またはアカウント乗っ取り（例：[有効なアカウント](https://attack.mitre.org/techniques/T1078)）などのその後の行動に役立つ可能性があります。

敵対者は、既存のツールの悪用、組み込みコマンド、ターゲット環境のアカウント名や役割・権限を漏洩させる可能性のある設定ミスなど、アカウントを列挙するためにいくつかの方法を使用するかもしれない。

例えば、クラウド環境では通常、ユーザーリストを取得するためのアクセスしやすいインターフェースが提供されている。(引用：AWS List Users)(引用：Google Cloud - IAM Servie Accounts List API) ホスト上では、敵対者はデフォルトの[PowerShell](https://attack.mitre.org/techniques/T1059/001)やその他のコマンドライン機能を使用してアカウントを特定することができる。メールアドレスやアカウントに関する情報は、感染したシステムのファイルを検索することによっても抽出される可能性がある。","Adversaries may attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment. This information can help adversaries determine which accounts exist, which can aid in follow-on behavior such as brute-forcing, spear-phishing attacks, or account takeovers (e.g., [Valid Accounts](https://attack.mitre.org/techniques/T1078)).

Adversaries may use several methods to enumerate accounts, including abuse of existing tools, built-in commands, and potential misconfigurations that leak account names and roles or permissions in the targeted environment.

For examples, cloud environments typically provide easily accessible interfaces to obtain user lists.(Citation: AWS List Users)(Citation: Google Cloud - IAM Servie Accounts List API) On hosts, adversaries can use default [PowerShell](https://attack.mitre.org/techniques/T1059/001) and other command line functionality to identify accounts. Information about email addresses and accounts may also be extracted by searching an infected system’s files.",T1087.003,メールアカウント,Email Account,"攻撃者は、メールアドレスとアカウントのリストを取得しようとする可能性があります。攻撃者は、グローバルアドレス一覧（GAL）などのExchangeアドレス一覧をダンプしようとする可能性があります。(引用: Microsoft Exchange Address Lists)

オンプレミスExchangeおよびExchange Onlineでは、<code>Get-GlobalAddressList</code> PowerShellコマンドレットを使用して、認証済みセッションを使用してドメインからメールアドレスとアカウントを取得できます。(引用: Microsoft getglobaladdresslist)(引用: Black Hills Attacking Exchange MailSniper, 2016)

Google Workspaceでは、GALはGoogle Workspace Sync for Microsoft Outlook (GWSMO)サービスを通じてMicrosoft Outlookユーザーと共有されます。さらに、Google Workspace Directoryにより、ユーザーは組織内の他のユーザーのリストを取得できます。(引用: Google Workspace Global Access List)","Adversaries may attempt to get a listing of email addresses and accounts. Adversaries may try to dump Exchange address lists such as global address lists (GALs).(Citation: Microsoft Exchange Address Lists)

In on-premises Exchange and Exchange Online, the <code>Get-GlobalAddressList</code> PowerShell cmdlet can be used to obtain email addresses and accounts from a domain using an authenticated session.(Citation: Microsoft getglobaladdresslist)(Citation: Black Hills Attacking Exchange MailSniper, 2016)

In Google Workspace, the GAL is shared with Microsoft Outlook users through the Google Workspace Sync for Microsoft Outlook (GWSMO) service. Additionally, the Google Workspace Directory allows for users to get a listing of other users within the organization.(Citation: Google Workspace Global Access List)",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1087,アカウントの探索,Account Discovery,"攻撃者は、システム上または侵害された環境内で有効なアカウント、ユーザー名、またはメールアドレスのリストを取得しようとする可能性があります。この情報は、攻撃者がどのアカウントが存在するかを判断するのに役立ち、ブルートフォース攻撃、スピアフィッシング攻撃、またはアカウント乗っ取り（例：[有効なアカウント](https://attack.mitre.org/techniques/T1078)）などのその後の行動に役立つ可能性があります。

敵対者は、既存のツールの悪用、組み込みコマンド、ターゲット環境のアカウント名や役割・権限を漏洩させる可能性のある設定ミスなど、アカウントを列挙するためにいくつかの方法を使用するかもしれない。

例えば、クラウド環境では通常、ユーザーリストを取得するためのアクセスしやすいインターフェースが提供されている。(引用：AWS List Users)(引用：Google Cloud - IAM Servie Accounts List API) ホスト上では、敵対者はデフォルトの[PowerShell](https://attack.mitre.org/techniques/T1059/001)やその他のコマンドライン機能を使用してアカウントを特定することができる。メールアドレスやアカウントに関する情報は、感染したシステムのファイルを検索することによっても抽出される可能性がある。","Adversaries may attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment. This information can help adversaries determine which accounts exist, which can aid in follow-on behavior such as brute-forcing, spear-phishing attacks, or account takeovers (e.g., [Valid Accounts](https://attack.mitre.org/techniques/T1078)).

Adversaries may use several methods to enumerate accounts, including abuse of existing tools, built-in commands, and potential misconfigurations that leak account names and roles or permissions in the targeted environment.

For examples, cloud environments typically provide easily accessible interfaces to obtain user lists.(Citation: AWS List Users)(Citation: Google Cloud - IAM Servie Accounts List API) On hosts, adversaries can use default [PowerShell](https://attack.mitre.org/techniques/T1059/001) and other command line functionality to identify accounts. Information about email addresses and accounts may also be extracted by searching an infected system’s files.",T1087.004,クラウドアカウント,Cloud Account,"攻撃者はクラウドアカウントのリストを取得しようとする可能性があります。クラウドアカウントとは、ユーザー、リモートサポート、サービス、またはクラウドサービスプロバイダーやSaaSアプリケーション内のリソースの管理のために組織によって作成および構成されたものです。

認証済みアクセスがあれば、アカウントを見つけるために使用できるいくつかのツールがあります。<code>Get-MsolRoleMember</code> PowerShellコマンドレットを使用して、Office 365の役割または権限グループを指定してアカウント名を取得できます。(引用: Microsoft msolrolemember)(引用: GitHub Raindance) Azure CLI (AZ CLI) も、ドメインへの認証済みアクセスを使用してユーザーアカウントを取得するためのインターフェイスを提供します。コマンド<code>az ad user list</code>は、ドメイン内のすべてのユーザーを一覧表示します。(引用: Microsoft AZ CLI)(引用: Black Hills Red Teaming MS AD Azure, 2018)

AWSコマンド<code>aws iam list-users</code>は現在のアカウントのユーザーリストを取得するために使用でき、一方<code>aws iam list-roles</code>は指定されたパスプレフィックスを持つIAMロールを取得できます。(引用: AWS List Roles)(引用: AWS List Users) GCPでは、<code>gcloud iam service-accounts list</code>と<code>gcloud projects get-iam-policy</code>を使用して、プロジェクト内のサービスアカウントとユーザーのリストを取得できます。(引用: Google Cloud - IAM Servie Accounts List API)","Adversaries may attempt to get a listing of cloud accounts. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application.

With authenticated access there are several tools that can be used to find accounts. The <code>Get-MsolRoleMember</code> PowerShell cmdlet can be used to obtain account names given a role or permissions group in Office 365.(Citation: Microsoft msolrolemember)(Citation: GitHub Raindance) The Azure CLI (AZ CLI) also provides an interface to obtain user accounts with authenticated access to a domain. The command <code>az ad user list</code> will list all users within a domain.(Citation: Microsoft AZ CLI)(Citation: Black Hills Red Teaming MS AD Azure, 2018) 

The AWS command <code>aws iam list-users</code> may be used to obtain a list of users in the current account while <code>aws iam list-roles</code> can obtain IAM roles that have a specified path prefix.(Citation: AWS List Roles)(Citation: AWS List Users) In GCP, <code>gcloud iam service-accounts list</code> and <code>gcloud projects get-iam-policy</code> may be used to obtain a listing of service accounts and users in a project.(Citation: Google Cloud - IAM Servie Accounts List API)",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1087,アカウントの探索,Account Discovery,"攻撃者は、システム上または侵害された環境内で有効なアカウント、ユーザー名、またはメールアドレスのリストを取得しようとする可能性があります。この情報は、攻撃者がどのアカウントが存在するかを判断するのに役立ち、ブルートフォース攻撃、スピアフィッシング攻撃、またはアカウント乗っ取り（例：[有効なアカウント](https://attack.mitre.org/techniques/T1078)）などのその後の行動に役立つ可能性があります。

敵対者は、既存のツールの悪用、組み込みコマンド、ターゲット環境のアカウント名や役割・権限を漏洩させる可能性のある設定ミスなど、アカウントを列挙するためにいくつかの方法を使用するかもしれない。

例えば、クラウド環境では通常、ユーザーリストを取得するためのアクセスしやすいインターフェースが提供されている。(引用：AWS List Users)(引用：Google Cloud - IAM Servie Accounts List API) ホスト上では、敵対者はデフォルトの[PowerShell](https://attack.mitre.org/techniques/T1059/001)やその他のコマンドライン機能を使用してアカウントを特定することができる。メールアドレスやアカウントに関する情報は、感染したシステムのファイルを検索することによっても抽出される可能性がある。","Adversaries may attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment. This information can help adversaries determine which accounts exist, which can aid in follow-on behavior such as brute-forcing, spear-phishing attacks, or account takeovers (e.g., [Valid Accounts](https://attack.mitre.org/techniques/T1078)).

Adversaries may use several methods to enumerate accounts, including abuse of existing tools, built-in commands, and potential misconfigurations that leak account names and roles or permissions in the targeted environment.

For examples, cloud environments typically provide easily accessible interfaces to obtain user lists.(Citation: AWS List Users)(Citation: Google Cloud - IAM Servie Accounts List API) On hosts, adversaries can use default [PowerShell](https://attack.mitre.org/techniques/T1059/001) and other command line functionality to identify accounts. Information about email addresses and accounts may also be extracted by searching an infected system’s files.",T1087.002,ドメインアカウント,Domain Account,"攻撃者はドメインアカウントのリストを取得しようとする可能性があります。この情報は、特定の権限を持つ特定のアカウントをターゲットにするなど、その後の行動に役立つドメインアカウントが存在するかどうかを攻撃者が判断するのに役立ちます。

[Net](https://attack.mitre.org/software/S0039)ユーティリティの<code>net user /domain</code>や<code>net group /domain</code>、macOSの<code>dscacheutil -q group</code>、Linuxの<code>ldapsearch</code>などのコマンドは、ドメインユーザーとグループを一覧表示できます。[PowerShell](https://attack.mitre.org/techniques/T1059/001)コマンドレット（<code>Get-ADUser</code>や<code>Get-ADGroupMember</code>など）は、Active Directoryグループのメンバーを列挙する場合があります。(引用: CrowdStrike StellarParticle January 2022)","Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior such as targeting specific accounts which possess particular privileges.

Commands such as <code>net user /domain</code> and <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain users and groups. [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlets including <code>Get-ADUser</code> and <code>Get-ADGroupMember</code> may enumerate members of Active Directory groups.(Citation: CrowdStrike StellarParticle January 2022)",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1087,アカウントの探索,Account Discovery,"攻撃者は、システム上または侵害された環境内で有効なアカウント、ユーザー名、またはメールアドレスのリストを取得しようとする可能性があります。この情報は、攻撃者がどのアカウントが存在するかを判断するのに役立ち、ブルートフォース攻撃、スピアフィッシング攻撃、またはアカウント乗っ取り（例：[有効なアカウント](https://attack.mitre.org/techniques/T1078)）などのその後の行動に役立つ可能性があります。

敵対者は、既存のツールの悪用、組み込みコマンド、ターゲット環境のアカウント名や役割・権限を漏洩させる可能性のある設定ミスなど、アカウントを列挙するためにいくつかの方法を使用するかもしれない。

例えば、クラウド環境では通常、ユーザーリストを取得するためのアクセスしやすいインターフェースが提供されている。(引用：AWS List Users)(引用：Google Cloud - IAM Servie Accounts List API) ホスト上では、敵対者はデフォルトの[PowerShell](https://attack.mitre.org/techniques/T1059/001)やその他のコマンドライン機能を使用してアカウントを特定することができる。メールアドレスやアカウントに関する情報は、感染したシステムのファイルを検索することによっても抽出される可能性がある。","Adversaries may attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment. This information can help adversaries determine which accounts exist, which can aid in follow-on behavior such as brute-forcing, spear-phishing attacks, or account takeovers (e.g., [Valid Accounts](https://attack.mitre.org/techniques/T1078)).

Adversaries may use several methods to enumerate accounts, including abuse of existing tools, built-in commands, and potential misconfigurations that leak account names and roles or permissions in the targeted environment.

For examples, cloud environments typically provide easily accessible interfaces to obtain user lists.(Citation: AWS List Users)(Citation: Google Cloud - IAM Servie Accounts List API) On hosts, adversaries can use default [PowerShell](https://attack.mitre.org/techniques/T1059/001) and other command line functionality to identify accounts. Information about email addresses and accounts may also be extracted by searching an infected system’s files.",T1087.001,ローカルアカウント,Local Account,"攻撃者はローカルシステムアカウントのリストを取得しようとする可能性があります。この情報は、攻撃者がシステム上にどのローカルアカウントが存在するかを判断し、その後の行動に役立てるのに役立ちます。

[Net](https://attack.mitre.org/software/S0039)ユーティリティの<code>net user</code>や<code>net localgroup</code>、macOSやLinuxの<code>id</code>や<code>groups</code>などのコマンドで、ローカルユーザーやグループを一覧表示できます。(引用: Mandiant APT1)(引用: id man page)(引用: groups man page) Linuxでは、<code>/etc/passwd</code>ファイルを使用してローカルユーザーを列挙することもできます。macOSでは、<code>dscl . list /Users</code>コマンドを使用してローカルアカウントを列挙できます。ESXiサーバーでは、<code>esxcli system account list</code>コマンドでローカルユーザーアカウントを一覧表示できます。(引用: Crowdstrike Hypervisor Jackpotting Pt 2 2021)","Adversaries may attempt to get a listing of local system accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior.

Commands such as <code>net user</code> and <code>net localgroup</code> of the [Net](https://attack.mitre.org/software/S0039) utility and <code>id</code> and <code>groups</code> on macOS and Linux can list local users and groups.(Citation: Mandiant APT1)(Citation: id man page)(Citation: groups man page) On Linux, local users can also be enumerated through the use of the <code>/etc/passwd</code> file. On macOS, the <code>dscl . list /Users</code> command can be used to enumerate local accounts. On ESXi servers, the `esxcli system account list` command can list local user accounts.(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1482,ドメイン信頼関係の探索,Domain Trust Discovery,攻撃者は、Windowsマルチドメイン/フォレスト環境での横方向の移動の機会を特定するために使用できるドメイン信頼関係に関する情報を収集しようとする可能性があります。ドメイン信頼は、ドメインが別のドメインの認証手順に基づいてリソースへのアクセスを許可するメカニズムを提供します。(引用: Microsoft Trusts) ドメイン信頼により、信頼されたドメインのユーザーは信頼するドメインのリソースにアクセスできます。発見された情報は、攻撃者が[SID履歴インジェクション](https://attack.mitre.org/techniques/T1134/005)、[パスザチケット](https://attack.mitre.org/techniques/T1550/003)、[Kerberoasting](https://attack.mitre.org/techniques/T1558/003)を実行するのに役立つ可能性があります。(引用: AdSecurity Forging Trust Tickets)(引用: Harmj0y Domain Trusts) ドメイン信頼は、<code>DSEnumerateDomainTrusts()</code> Win32 API呼び出し、.NETメソッド、およびLDAPを使用して列挙できます。(引用: Harmj0y Domain Trusts) Windowsユーティリティ[Nltest](https://attack.mitre.org/software/S0359)は、ドメイン信頼を列挙するために攻撃者によって使用されることが知られています。(引用: Microsoft Operation Wilysupply),"Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments. Domain trusts provide a mechanism for a domain to allow access to resources based on the authentication procedures of another domain.(Citation: Microsoft Trusts) Domain trusts allow the users of the trusted domain to access resources in the trusting domain. The information discovered may help the adversary conduct [SID-History Injection](https://attack.mitre.org/techniques/T1134/005), [Pass the Ticket](https://attack.mitre.org/techniques/T1550/003), and [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).(Citation: AdSecurity Forging Trust Tickets)(Citation: Harmj0y Domain Trusts) Domain trusts can be enumerated using the `DSEnumerateDomainTrusts()` Win32 API call, .NET methods, and LDAP.(Citation: Harmj0y Domain Trusts) The Windows utility [Nltest](https://attack.mitre.org/software/S0359) is known to be used by adversaries to enumerate domain trusts.(Citation: Microsoft Operation Wilysupply)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1083,ファイルとディレクトリの探索,File and Directory Discovery,"攻撃者は、ファイルシステム内の特定の情報について、ファイルやディレクトリを列挙したり、ホストやネットワーク共有の特定の場所を検索したりする可能性があります。攻撃者は、自動検出中に[ファイルとディレクトリの発見](https://attack.mitre.org/techniques/T1083)からの情報を使用して、攻撃者がターゲットを完全に感染させるかどうかや、特定のアクションを試みるかどうかなど、その後の行動を形成する可能性があります。

多くのコマンドシェルユーティリティを使用してこの情報を取得できます。例としては、<code>dir</code>、<code>tree</code>、<code>ls</code>、<code>find</code>、<code>locate</code>などがあります。(引用: Windows Commands JPCERT) カスタムツールを使用してファイルやディレクトリの情報を収集し、[ネイティブAPI](https://attack.mitre.org/techniques/T1106)と対話することもできます。攻撃者はまた、ネットワークデバイス上の[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)を利用してファイルやディレクトリの情報を収集する（例：<code>dir</code>、<code>show flash</code>、および/または<code>nvram</code>）可能性があります。(引用: US-CERT-TA18-106A)

一部のファイルやディレクトリへのアクセスには、昇格された権限または特定のユーザー権限が必要になる場合があります。","Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Many command shell utilities can be used to obtain this information. Examples include <code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, and <code>locate</code>.(Citation: Windows Commands JPCERT) Custom tools may also be used to gather file and directory information and interact with the [Native API](https://attack.mitre.org/techniques/T1106). Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather file and directory information (e.g. <code>dir</code>, <code>show flash</code>, and/or <code>nvram</code>).(Citation: US-CERT-TA18-106A)

Some files and directories may require elevated or specific user permissions to access.",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1049,システムネットワーク接続の探索,System Network Connections Discovery,"攻撃者は、現在アクセスしている侵害されたシステムから、またはネットワーク経由で情報を照会することによりリモートシステムから、ネットワーク接続のリストを取得しようとする可能性があります。

クラウドベースの環境の一部であるシステムにアクセスした攻撃者は、接続されているシステムやサービスを特定するために、仮想プライベートクラウドや仮想ネットワークをマッピングする可能性があります。実行されるアクションは、オペレーティングシステムに応じて同じ種類の検出テクニックである可能性が高いですが、結果として得られる情報には、攻撃者の目標に関連するネットワーク化されたクラウド環境に関する詳細が含まれる場合があります。クラウドプロバイダーは、仮想ネットワークの動作方法が異なる場合があります。(引用: Amazon AWS VPC Guide)(引用: Microsoft Azure Virtual Network Overview)(引用: Google VPC Overview) 同様に、ネットワークデバイスへのアクセスを取得した攻撃者は、接続されているシステムやサービスに関する情報を収集するために同様の検出アクティビティを実行する可能性があります。

この情報を取得するユーティリティとコマンドには、[netstat](https://attack.mitre.org/software/S0104)、「net use」、および[Net](https://attack.mitre.org/software/S0039)を使用した「net session」が含まれます。MacおよびLinuxでは、[netstat](https://attack.mitre.org/software/S0104)および<code>lsof</code>を使用して現在の接続を一覧表示できます。<code>who -a</code>および<code>w</code>を使用して、現在ログインしているユーザーを表示できます（「net session」と同様）。さらに、ネットワークデバイスにネイティブな組み込み機能や[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)を使用できます（例：<code>show ip sockets</code>、<code>show tcp brief</code>）。(引用: US-CERT-TA18-106A) ESXiサーバーでは、コマンド<code>esxi network ip connection list</code>を使用してアクティブなネットワーク接続を一覧表示できます。(引用: Sygnia ESXi Ransomware 2025)","Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. 

An adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate.(Citation: Amazon AWS VPC Guide)(Citation: Microsoft Azure Virtual Network Overview)(Citation: Google VPC Overview) Similarly, adversaries who gain access to network devices may also perform similar discovery activities to gather information about connected systems and services.

Utilities and commands that acquire this information include [netstat](https://attack.mitre.org/software/S0104), \""net use,\"" and \""net session\"" with [Net](https://attack.mitre.org/software/S0039). In Mac and Linux, [netstat](https://attack.mitre.org/software/S0104) and <code>lsof</code> can be used to list current connections. <code>who -a</code> and <code>w</code> can be used to show which users are currently logged in, similar to \""net session\"". Additionally, built-in features native to network devices and [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) may be used (e.g. <code>show ip sockets</code>, <code>show tcp brief</code>).(Citation: US-CERT-TA18-106A) On ESXi servers, the command `esxi network ip connection list` can be used to list active network connections.(Citation: Sygnia ESXi Ransomware 2025)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1497,仮想化/サンドボックス回避,Virtualization/Sandbox Evasion,"攻撃者は、仮想化および分析環境を検出して回避するために、さまざまな手段を用いる可能性があります。これには、仮想マシン環境（VME）またはサンドボックスを示すアーティファクトの存在のチェック結果に基づいて動作を変更することが含まれる場合があります。攻撃者がVMEを検出した場合、マルウェアを変更して被害者から切り離したり、インプラントのコア機能を隠したりする可能性があります。また、セカンダリペイロードまたは追加ペイロードをドロップする前にVMEアーティファクトを検索することもあります。攻撃者は、自動検出中に[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)から学習した情報を使用して、その後の動作を形成する可能性があります。(引用: Deloitte Environment Awareness)

攻撃者は、セキュリティ監視ツール（Sysinternals、Wiresharkなど）や、分析または仮想化に関連するその他のシステムアーティファクトのチェックなど、[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)を達成するためにいくつかの方法を使用する可能性があります。攻撃者はまた、正当なユーザーアクティビティをチェックして、分析環境にあるかどうかを判断するのに役立てることもあります。追加の方法には、一時的なサンドボックス内で動作することを避けるために、マルウェアコード内でスリープタイマーまたはループを使用することが含まれます。(引用: Unit 42 Pirpi July 2015)","Adversaries may employ various means to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness)

Adversaries may use several methods to accomplish [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) such as checking for security monitoring tools (e.g., Sysinternals, Wireshark, etc.) or other system artifacts associated with analysis or virtualization. Adversaries may also check for legitimate user activity to help determine if it is in an analysis environment. Additional methods include use of sleep timers or loops within malware code to avoid operating within a temporary sandbox.(Citation: Unit 42 Pirpi July 2015)",T1497.002,ユーザーアクティビティベースのチェック,User Activity Based Checks,"攻撃者は、仮想化および分析環境を検出して回避するために、さまざまなユーザーアクティビティチェックを採用する可能性があります。これには、仮想マシン環境（VME）またはサンドボックスを示すアーティファクトの存在のチェック結果に基づいて動作を変更することが含まれる場合があります。攻撃者がVMEを検出した場合、マルウェアを変更して被害者から切り離したり、インプラントのコア機能を隠したりする可能性があります。また、セカンダリペイロードまたは追加ペイロードをドロップする前にVMEアーティファクトを検索することもあります。攻撃者は、自動検出中に[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)から学習した情報を使用して、その後の動作を形成する可能性があります。(引用: Deloitte Environment Awareness)

敵対者は、マウスの動きやクリックの速度/頻度(引用：Sans Virtual Jan 2016)、ブラウザの履歴、キャッシュ、ブックマーク、あるいはホームやデスクトップなどの共通ディレクトリ内のファイル数といった変数に基づいて、ホスト上のユーザー活動を検索するかもしれない。他の方法では、悪意のあるコードがアクティブ化される前にシステムとの特定のユーザーインタラクションに依存するかもしれず、例えば、マクロをアクティブ化する前にドキュメントが閉じるのを待ったり(引用：Unit 42 Sofacy Nov 2018)、アクティブ化するためにユーザーが埋め込み画像をダブルクリックするのを待ったりするなどです(引用：FireEye FIN7 April 2017)。","Adversaries may employ various user activity checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness)

Adversaries may search for user activity on the host based on variables such as the speed/frequency of mouse movements and clicks (Citation: Sans Virtual Jan 2016) , browser history, cache, bookmarks, or number of files in common directories such as home or the desktop. Other methods may rely on specific user interaction with the system before the malicious code is activated, such as waiting for a document to close before activating a macro (Citation: Unit 42 Sofacy Nov 2018) or waiting for a user to double click on an embedded image to activate.(Citation: FireEye FIN7 April 2017)",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1497,仮想化/サンドボックス回避,Virtualization/Sandbox Evasion,"攻撃者は、仮想化および分析環境を検出して回避するために、さまざまな手段を用いる可能性があります。これには、仮想マシン環境（VME）またはサンドボックスを示すアーティファクトの存在のチェック結果に基づいて動作を変更することが含まれる場合があります。攻撃者がVMEを検出した場合、マルウェアを変更して被害者から切り離したり、インプラントのコア機能を隠したりする可能性があります。また、セカンダリペイロードまたは追加ペイロードをドロップする前にVMEアーティファクトを検索することもあります。攻撃者は、自動検出中に[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)から学習した情報を使用して、その後の動作を形成する可能性があります。(引用: Deloitte Environment Awareness)

攻撃者は、セキュリティ監視ツール（Sysinternals、Wiresharkなど）や、分析または仮想化に関連するその他のシステムアーティファクトのチェックなど、[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)を達成するためにいくつかの方法を使用する可能性があります。攻撃者はまた、正当なユーザーアクティビティをチェックして、分析環境にあるかどうかを判断するのに役立てることもあります。追加の方法には、一時的なサンドボックス内で動作することを避けるために、マルウェアコード内でスリープタイマーまたはループを使用することが含まれます。(引用: Unit 42 Pirpi July 2015)","Adversaries may employ various means to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness)

Adversaries may use several methods to accomplish [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) such as checking for security monitoring tools (e.g., Sysinternals, Wireshark, etc.) or other system artifacts associated with analysis or virtualization. Adversaries may also check for legitimate user activity to help determine if it is in an analysis environment. Additional methods include use of sleep timers or loops within malware code to avoid operating within a temporary sandbox.(Citation: Unit 42 Pirpi July 2015)",T1497.001,システムチェック,System Checks,"攻撃者は、仮想化および分析環境を検出して回避するために、さまざまなシステムチェックを採用する可能性があります。これには、仮想マシン環境（VME）またはサンドボックスを示すアーティファクトの存在のチェック結果に基づいて動作を変更することが含まれる場合があります。攻撃者がVMEを検出した場合、マルウェアを変更して被害者から切り離したり、インプラントのコア機能を隠したりする可能性があります。また、セカンダリペイロードまたは追加ペイロードをドロップする前にVMEアーティファクトを検索することもあります。攻撃者は、自動検出中に[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)から学習した情報を使用して、その後の動作を形成する可能性があります。(引用: Deloitte Environment Awareness)

特定のチェックはターゲットや攻撃者によって異なりますが、システム情報を取得しVMEアーティファクトを検索するために、[Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047)、[PowerShell](https://attack.mitre.org/techniques/T1059/001)、[システム情報ディスカバリ](https://attack.mitre.org/techniques/T1082)、[レジストリクエリ](https://attack.mitre.org/techniques/T1012)などの動作が含まれる場合があります。攻撃者は、メモリ、プロセス、ファイルシステム、ハードウェア、および/またはレジストリでVMEアーティファクトを検索する場合があります。攻撃者は、これらのチェックを1つのスクリプトに自動化するためにスクリプトを使用し、システムが仮想環境であると判断した場合にプログラムを終了させる場合があります。

チェックには、ホスト/ドメイン名やネットワークトラフィックのサンプルなどの一般的なシステムプロパティが含まれる場合があります。攻撃者はまた、ネットワークアダプタのアドレス、CPUコア数、利用可能なメモリ/ドライブサイズを確認する場合があります。実行されると、マルウェアは[ファイルとディレクトリの発見](https://attack.mitre.org/techniques/T1083)を使用して、`malware`、`sample`、`hash`などの予期しない、あるいは分析に関連する名前付けアーティファクトを持つフォルダやファイルに保存されたかどうかを確認する場合があります。

その他の一般的なチェックには、これらのアプリケーションに固有の実行中のサービスの列挙、システムにインストールされているプログラム、仮想マシンアプリケーションに関連する文字列の製造元/製品フィールド、およびVME固有のハードウェア/プロセッサ命令が含まれる場合があります。(引用: McAfee Virtual Jan 2017) VMWareなどのアプリケーションでは、攻撃者は特別なI/Oポートを使用してコマンドを送信し、出力を受信することもできます。

ファン、温度、オーディオデバイスの存在などのハードウェアチェックも、仮想環境を示す可能性のある証拠を収集するために使用できます。攻撃者はまた、これらのデバイスから特定の測定値を照会する場合があります。(引用: Unit 42 OilRig Sept 2018)","Adversaries may employ various system checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness)

Specific checks will vary based on the target and/or adversary, but may involve behaviors such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047), [PowerShell](https://attack.mitre.org/techniques/T1059/001), [System Information Discovery](https://attack.mitre.org/techniques/T1082), and [Query Registry](https://attack.mitre.org/techniques/T1012) to obtain system information and search for VME artifacts. Adversaries may search for VME artifacts in memory, processes, file system, hardware, and/or the Registry. Adversaries may use scripting to automate these checks  into one script and then have the program exit if it determines the system to be a virtual environment. 

Checks could include generic system properties such as host/domain name and samples of network traffic. Adversaries may also check the network adapters addresses, CPU core count, and available memory/drive size. Once executed, malware may also use [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) to check if it was saved in a folder or file with unexpected or even analysis-related naming artifacts such as `malware`, `sample`, or `hash`.

Other common checks may enumerate services running that are unique to these applications, installed programs on the system, manufacturer/product fields for strings relating to virtual machine applications, and VME-specific hardware/processor instructions.(Citation: McAfee Virtual Jan 2017) In applications like VMWare, adversaries can also use a special I/O port to send commands and receive output. \n \nHardware checks, such as the presence of the fan, temperature, and audio devices, could also be used to gather evidence that can be indicative a virtual environment. Adversaries may also query for specific readings from these devices.(Citation: Unit 42 OilRig Sept 2018)",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1497,仮想化/サンドボックス回避,Virtualization/Sandbox Evasion,"攻撃者は、仮想化および分析環境を検出して回避するために、さまざまな手段を用いる可能性があります。これには、仮想マシン環境（VME）またはサンドボックスを示すアーティファクトの存在のチェック結果に基づいて動作を変更することが含まれる場合があります。攻撃者がVMEを検出した場合、マルウェアを変更して被害者から切り離したり、インプラントのコア機能を隠したりする可能性があります。また、セカンダリペイロードまたは追加ペイロードをドロップする前にVMEアーティファクトを検索することもあります。攻撃者は、自動検出中に[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)から学習した情報を使用して、その後の動作を形成する可能性があります。(引用: Deloitte Environment Awareness)

攻撃者は、セキュリティ監視ツール（Sysinternals、Wiresharkなど）や、分析または仮想化に関連するその他のシステムアーティファクトのチェックなど、[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)を達成するためにいくつかの方法を使用する可能性があります。攻撃者はまた、正当なユーザーアクティビティをチェックして、分析環境にあるかどうかを判断するのに役立てることもあります。追加の方法には、一時的なサンドボックス内で動作することを避けるために、マルウェアコード内でスリープタイマーまたはループを使用することが含まれます。(引用: Unit 42 Pirpi July 2015)","Adversaries may employ various means to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness)

Adversaries may use several methods to accomplish [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) such as checking for security monitoring tools (e.g., Sysinternals, Wireshark, etc.) or other system artifacts associated with analysis or virtualization. Adversaries may also check for legitimate user activity to help determine if it is in an analysis environment. Additional methods include use of sleep timers or loops within malware code to avoid operating within a temporary sandbox.(Citation: Unit 42 Pirpi July 2015)",T1497.003,時間ベースの回避,Time Based Evasion,"攻撃者は、仮想化および分析環境を検出して回避するために、さまざまな時間ベースの方法を採用する可能性があります。これには、稼働時間やシステムクロックなどの時間ベースのプロパティの列挙、および仮想マシン環境（VME）またはサンドボックス（特に自動化されているか、限られた時間しか動作しないもの）を回避するためのタイマーまたはその他のトリガーの使用が含まれる場合があります。

攻撃者は、プログラムによるスリープコマンドやネイティブシステムスケジューリング機能（例：[スケジュールされたタスク/ジョブ](https://attack.mitre.org/techniques/T1053)）を使用して初期実行時にマルウェアの機能を遅延させるなど、さまざまな時間ベースの回避策を用いる可能性があります。遅延は、特定の被害者の条件（例：システム時刻、イベントなど）が満たされるのを待つことに基づく場合もあれば、分析や精査を回避するためにスケジュールされた[多段階チャネル](https://attack.mitre.org/techniques/T1104)を使用する場合もあります。(引用: Deloitte Environment Awareness)

良性のコマンドやその他の操作も、マルウェアの実行を遅らせるために使用される場合があります。[Ping](https://attack.mitre.org/software/S0097)などのコマンドのループや不必要な繰り返しは、マルウェアの実行を遅らせ、自動分析環境の時間的しきい値を超える可能性があります。(引用: Revil Independence Day)(引用: Netskope Nitol) APIハンマリングとして一般的に知られている別のバリエーションは、実行を遅らせるために[ネイティブAPI](https://attack.mitre.org/techniques/T1106)関数へのさまざまな呼び出しを行うことを含みます（同時に、ジャンクデータで分析環境を過負荷にする可能性もあります）。(引用: Joe Sec Nymaim)(引用: Joe Sec Trickbot)

攻撃者はまた、時間を指標として使用してサンドボックスや分析環境を検出することもあります。特に、長時間の経過をシミュレートするために時間メカニズムを操作しようとするものを検出します。例えば、攻撃者は、スリープ関数の実行前後に環境のタイムスタンプの期待値をサンプリングして計算することにより、時間を加速させているサンドボックスを特定できる場合があります。(引用: ISACA Malware Tricks)","Adversaries may employ various time-based methods to detect and avoid virtualization and analysis environments. This may include enumerating time-based properties, such as uptime or the system clock, as well as the use of timers or other triggers to avoid a virtual machine environment (VME) or sandbox, specifically those that are automated or only operate for a limited amount of time.

Adversaries may employ various time-based evasions, such as delaying malware functionality upon initial execution using programmatic sleep commands or native system scheduling functionality (ex: [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053)). Delays may also be based on waiting for specific victim conditions to be met (ex: system time, events, etc.) or employ scheduled [Multi-Stage Channels](https://attack.mitre.org/techniques/T1104) to avoid analysis and scrutiny.(Citation: Deloitte Environment Awareness)

Benign commands or other operations may also be used to delay malware execution. Loops or otherwise needless repetitions of commands, such as [Ping](https://attack.mitre.org/software/S0097)s, may be used to delay malware execution and potentially exceed time thresholds of automated analysis environments.(Citation: Revil Independence Day)(Citation: Netskope Nitol) Another variation, commonly referred to as API hammering, involves making various calls to [Native API](https://attack.mitre.org/techniques/T1106) functions in order to delay execution (while also potentially overloading analysis environments with junk data).(Citation: Joe Sec Nymaim)(Citation: Joe Sec Trickbot)

Adversaries may also use time as a metric to detect sandboxes and analysis environments, particularly those that attempt to manipulate time mechanisms to simulate longer elapses of time. For example, an adversary may be able to identify a sandbox accelerating time by sampling and calculating the expected value for an environment's timestamp before and after execution of a sleep function.(Citation: ISACA Malware Tricks)",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1619,クラウドストレージオブジェクトの探索,Cloud Storage Object Discovery,"攻撃者はクラウドストレージインフラストラクチャ内のオブジェクトを列挙する可能性があります。攻撃者は、自動検出中にこの情報を使用して、クラウドストレージからすべてまたは特定のオブジェクトを要求するなど、その後の行動を形成する可能性があります。ローカルホスト上の[ファイルとディレクトリの発見](https://attack.mitre.org/techniques/T1083)と同様に、利用可能なストレージサービスを特定した後（つまり、[クラウドインフラストラクチャの発見](https://attack.mitre.org/techniques/T1580)）、攻撃者はクラウドインフラストラクチャに保存されているコンテンツ/オブジェクトにアクセスする可能性があります。

クラウドサービスプロバイダーは、ユーザーがクラウドストレージ内に保存されているオブジェクトを列挙できるようにするAPIを提供しています。例としては、AWSのListObjectsV2 (引用: ListObjectsV2) やAzureのList Blobs (引用: List Blobs) などがあります。","Adversaries may enumerate objects in cloud storage infrastructure. Adversaries may use this information during automated discovery to shape follow-on behaviors, including requesting all or specific objects from cloud storage.  Similar to [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) on a local host, after identifying available storage services (i.e. [Cloud Infrastructure Discovery](https://attack.mitre.org/techniques/T1580)) adversaries may access the contents/objects stored in cloud infrastructure.

Cloud service providers offer APIs allowing users to enumerate objects stored within cloud storage. Examples include ListObjectsV2 in AWS (Citation: ListObjectsV2) and List Blobs in Azure(Citation: List Blobs) .",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1654,ログ列挙,Log Enumeration,"攻撃者は、有用なデータを見つけるためにシステムおよびサービスログを列挙する可能性があります。これらのログは、ユーザー認証記録（[アカウントディスカバリ](https://attack.mitre.org/techniques/T1087)）、セキュリティまたは脆弱なソフトウェア（[ソフトウェアディスカバリ](https://attack.mitre.org/techniques/T1518)）、または侵害されたネットワーク内のホスト（[リモートシステムディスカバリ](https://attack.mitre.org/techniques/T1018)）など、攻撃者にとってさまざまな種類の貴重な洞察を浮き彫りにする可能性があります。

ホストバイナリを利用してシステムログを収集することができます。例としては、Windowsで`wevtutil.exe`や[PowerShell](https://attack.mitre.org/techniques/T1059/001)を使用してセキュリティイベント情報にアクセスしたりエクスポートしたりすることが挙げられます。(引用: WithSecure Lazarus-NoPineapple Threat Intel Report 2023)(引用: Cadet Blizzard emerges as novel threat actor) クラウド環境では、攻撃者はAzure VM Agentの`CollectGuestLogs.exe`などのユーティリティを利用して、クラウドホスト型インフラストラクチャからセキュリティログを収集する可能性があります。(引用: SIM Swapping and Abuse of the Microsoft Azure Serial Console)

攻撃者はまた、SIEMなどの集中ログ記録インフラストラクチャを標的にする可能性があります。ログはまた、オフライン分析のために一括エクスポートされ、攻撃者が制御するインフラストラクチャに送信される場合もあります。

環境をよりよく理解することに加えて、攻撃者はインシデント対応手順をリアルタイムで追跡するためにログを監視することもあります。これにより、永続性を維持したり防御を回避したりするためにテクニックを調整できる可能性があります。(引用: Permiso GUI-Vil 2023)","Adversaries may enumerate system and service logs to find useful data. These logs may highlight various types of valuable insights for an adversary, such as user authentication records ([Account Discovery](https://attack.mitre.org/techniques/T1087)), security or vulnerable software ([Software Discovery](https://attack.mitre.org/techniques/T1518)), or hosts within a compromised network ([Remote System Discovery](https://attack.mitre.org/techniques/T1018)).

Host binaries may be leveraged to collect system logs. Examples include using `wevtutil.exe` or [PowerShell](https://attack.mitre.org/techniques/T1059/001) on Windows to access and/or export security event information.(Citation: WithSecure Lazarus-NoPineapple Threat Intel Report 2023)(Citation: Cadet Blizzard emerges as novel threat actor) In cloud environments, adversaries may leverage utilities such as the Azure VM Agent’s `CollectGuestLogs.exe` to collect security logs from cloud hosted infrastructure.(Citation: SIM Swapping and Abuse of the Microsoft Azure Serial Console)

Adversaries may also target centralized logging infrastructure such as SIEMs. Logs may also be bulk exported and sent to adversary-controlled infrastructure for offline analysis.

In addition to gaining a better understanding of the environment, adversaries may also monitor logs in real time to track incident response procedures. This may allow them to adjust their techniques in order to maintain persistence or evade defenses.(Citation: Permiso GUI-Vil 2023)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1057,プロセス探索,Process Discovery,"攻撃者は、システム上で実行中のプロセスに関する情報を取得しようとする可能性があります。取得された情報は、ネットワーク内のシステムで実行されている一般的なソフトウェア/アプリケーションを理解するために使用できます。管理者またはその他の昇格されたアクセス権により、より詳細なプロセス情報を取得できる場合があります。攻撃者は、自動検出中に[プロセスディスカバリ](https://attack.mitre.org/techniques/T1057)からの情報を使用して、攻撃者がターゲットを完全に感染させるかどうか、および/または特定のアクションを試みるかどうかなど、その後の行動を形成する可能性があります。

Windows環境では、攻撃者は[cmd](https://attack.mitre.org/software/S0106)を介した[Tasklist](https://attack.mitre.org/software/S0057)ユーティリティ、または[PowerShell](https://attack.mitre.org/techniques/T1059/001)を介した<code>Get-Process</code>を使用して、実行中のプロセスに関する詳細を取得できます。プロセスに関する情報は、<code>CreateToolhelp32Snapshot</code>などの[ネイティブAPI](https://attack.mitre.org/techniques/T1106)呼び出しの出力からも抽出できます。MacおよびLinuxでは、これは<code>ps</code>コマンドで実行されます。攻撃者はまた、`/proc`を介してプロセスを列挙することを選択する場合があります。ESXiも、<code>ps</code>コマンドおよび<code>esxcli system process list</code>の使用をサポートしています。(引用: Sygnia ESXi Ransomware 2025)(引用: Crowdstrike Hypervisor Jackpotting Pt 2 2021)

ネットワークデバイスでは、<code>show processes</code>などの[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)コマンドを使用して、現在実行中のプロセスを表示できます。(引用: US-CERT-TA18-106A)(引用: show_processes_cisco_cmd)","Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Administrator or otherwise elevated access may provide better process details. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

In Windows environments, adversaries could obtain details on running processes using the [Tasklist](https://attack.mitre.org/software/S0057) utility via [cmd](https://attack.mitre.org/software/S0106) or <code>Get-Process</code> via [PowerShell](https://attack.mitre.org/techniques/T1059/001). Information about processes can also be extracted from the output of [Native API](https://attack.mitre.org/techniques/T1106) calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via `/proc`. ESXi also supports use of the `ps` command, as well as `esxcli system process list`.(Citation: Sygnia ESXi Ransomware 2025)(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)

On network devices, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `show processes` can be used to display current running processes.(Citation: US-CERT-TA18-106A)(Citation: show_processes_cisco_cmd)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1201,パスワードポリシーの探索,Password Policy Discovery,"攻撃者は、エンタープライズネットワークまたはクラウド環境内で使用されているパスワードポリシーに関する詳細情報にアクセスしようとする可能性があります。パスワードポリシーは、[ブルートフォース](https://attack.mitre.org/techniques/T1110)によって推測または解読が困難な複雑なパスワードを強制する方法です。この情報は、攻撃者が一般的なパスワードのリストを作成し、ポリシーに準拠した辞書攻撃および/またはブルートフォース攻撃を開始するのに役立つ可能性があります（例：最小パスワード長が8の場合、「pass123」などのパスワードは試行しない。アカウントをロックアウトしないように、ロックアウトが6に設定されている場合はアカウントごとに3〜4個を超えるパスワードはチェックしない）。

パスワードポリシーは、<code>net accounts (/domain)</code>、<code>Get-ADDefaultDomainPasswordPolicy</code>、<code>chage -l <username></code>、<code>cat /etc/pam.d/common-password</code>、<code>pwpolicy getaccountpolicies</code>など、さまざまなコマンドシェルユーティリティを介してWindows、Linux、macOSシステムで設定および検出できます。(引用: Superuser Linux Password Policies)(引用: Jamf User Password Policies) 攻撃者はまた、ネットワークデバイス上の[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)を利用してパスワードポリシー情報を検出する（例：<code>show aaa</code>、<code>show aaa common-criteria policy all</code>）可能性があります。(引用: US-CERT-TA18-106A)

パスワードポリシーは、AWSの<code>GetAccountPasswordPolicy</code>など、利用可能なAPIを使用してクラウド環境で検出できます。(引用：AWS GetPasswordPolicy)","Adversaries may attempt to access detailed information about the password policy used within an enterprise network or cloud environment. Password policies are a way to enforce complex passwords that are difficult to guess or crack through [Brute Force](https://attack.mitre.org/techniques/T1110). This information may help the adversary to create a list of common passwords and launch dictionary and/or brute force attacks which adheres to the policy (e.g. if the minimum password length should be 8, then not trying passwords such as 'pass123'; not checking for more than 3-4 passwords per account if the lockout is set to 6 as to not lock out accounts).

Password policies can be set and discovered on Windows, Linux, and macOS systems via various command shell utilities such as <code>net accounts (/domain)</code>, <code>Get-ADDefaultDomainPasswordPolicy</code>, <code>chage -l <username></code>, <code>cat /etc/pam.d/common-password</code>, and <code>pwpolicy getaccountpolicies</code> (Citation: Superuser Linux Password Policies) (Citation: Jamf User Password Policies). Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to discover password policy information (e.g. <code>show aaa</code>, <code>show aaa common-criteria policy all</code>).(Citation: US-CERT-TA18-106A)

Password policies can be discovered in cloud environments using available APIs such as <code>GetAccountPasswordPolicy</code> in AWS (Citation: AWS GetPasswordPolicy).",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1012,レジストリクエリ,Query Registry,"攻撃者はWindowsレジストリと対話して、システム、構成、インストール済みソフトウェアに関する情報を収集する可能性があります。

レジストリには、オペレーティングシステム、構成、ソフトウェア、セキュリティに関する大量の情報が含まれています。(引用: Wikipedia Windows Registry) 情報は[Reg](https://attack.mitre.org/software/S0075)ユーティリティを使用して簡単に照会できますが、レジストリにアクセスする他の手段も存在します。一部の情報は、攻撃者がネットワーク内で操作をさらに進めるのに役立つ場合があります。攻撃者は、自動検出中に[レジストリクエリ](https://attack.mitre.org/techniques/T1012)からの情報を使用して、攻撃者がターゲットを完全に感染させるかどうか、および/または特定のアクションを試みるかどうかなど、その後の行動を形成する可能性があります。","Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.

The Registry contains a significant amount of information about the operating system, configuration, software, and security.(Citation: Wikipedia Windows Registry) Information can easily be queried using the [Reg](https://attack.mitre.org/software/S0075) utility, though other means to access the Registry exist. Some of the information may help adversaries to further their operation within a network. Adversaries may use the information from [Query Registry](https://attack.mitre.org/techniques/T1012) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1614,システムロケーションの探索,System Location Discovery,"攻撃者は、被害者ホストの地理的位置を計算するために情報を収集しようとする可能性があります。攻撃者は、自動検出中に[システムロケーションディスカバリ](https://attack.mitre.org/techniques/T1614)からの情報を使用して、攻撃者がターゲットを完全に感染させるかどうか、および/または特定のアクションを試みるかどうかなど、その後の行動を形成する可能性があります。

敵対者は、タイムゾーン、キーボードレイアウト、言語設定などの様々なシステムチェックを使用して、システムの場所を推測しようとするかもしれません。(引用：FBI Ragnar Locker 2020)(引用：Sophos Geolocation 2016)(引用：Bleepingcomputer RAT malware 2020) <code>GetLocaleInfoW</code>のようなWindows API関数も、ホストのロケールを決定するために使用することができます。(引用：FBI Ragnar Locker 2020) クラウド環境では、インスタンスからインスタンスメタデータサービスにアクセスすることで、インスタンスのアベイラビリティゾーンも発見されるかもしれません。(引用：AWS Instance Identity Documents)(引用：Microsoft Azure Instance Metadata 2021)

敵対者はまた、オンラインの地理位置情報IPルックアップサービスなどを介して、IPアドレッシングを使用して被害者ホストの場所を推測しようとするかもしれません。(引用：Securelist Trasparent Tribe 2020)(引用：Sophos Geolocation 2016)","Adversaries may gather information in an attempt to calculate the geographical location of a victim host. Adversaries may use the information from [System Location Discovery](https://attack.mitre.org/techniques/T1614) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Adversaries may attempt to infer the location of a system using various system checks, such as time zone, keyboard layout, and/or language settings.(Citation: FBI Ragnar Locker 2020)(Citation: Sophos Geolocation 2016)(Citation: Bleepingcomputer RAT malware 2020) Windows API functions such as <code>GetLocaleInfoW</code> can also be used to determine the locale of the host.(Citation: FBI Ragnar Locker 2020) In cloud environments, an instance's availability zone may also be discovered by accessing the instance metadata service from the instance.(Citation: AWS Instance Identity Documents)(Citation: Microsoft Azure Instance Metadata 2021)

Adversaries may also attempt to infer the location of a victim host using IP addressing, such as via online geolocation IP-lookup services.(Citation: Securelist Trasparent Tribe 2020)(Citation: Sophos Geolocation 2016)",T1614.001,システム言語の探索,System Language Discovery,"攻撃者は、そのホストの地理的な場所を推測するために、被害者のシステム言語に関する情報を収集しようとする可能性があります。この情報は、攻撃者がターゲットに感染するかどうか、および/または特定のアクションを試みるかどうかなど、その後の行動を形成するために使用される場合があります。この決定は、特定の法執行機関の注意を引いたり、他のエンティティからの起訴/精査のリスクを軽減したりするために、マルウェア開発者やオペレーターによって採用される場合があります。(引用: Malware System Language Check)

システム言語を推測するために攻撃者が使用できるデータソースは、システムのデフォルトやキーボードレイアウトなど、さまざまです。特定のチェックはターゲットや攻撃者によって異なりますが、[レジストリクエリ](https://attack.mitre.org/techniques/T1012)や[ネイティブAPI](https://attack.mitre.org/techniques/T1106)関数への呼び出しなどの動作が含まれる場合があります。(引用: CrowdStrike Ryuk January 2019)

例えば、Windowsシステムでは、敵対者はレジストリキー<code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Language</code>を照会したり、Windows API関数<code>GetUserDefaultUILanguage</code>、<code>GetSystemDefaultUILanguage</code>、<code>GetKeyboardLayoutList</code>、<code>GetUserDefaultLangID</code>の出力を解析したりすることで、システムの言語を推測しようとするかもしれません。(引用：Darkside Ransomware Cybereason）（引用：Securelist JSWorm）（引用：SecureList SynAck Doppelgänging May 2018）

macOSまたはLinuxシステムでは、攻撃者は<code>locale</code>を照会して<code>$LANG</code>環境変数の値を取得する可能性があります。","Adversaries may attempt to gather information about the system language of a victim in order to infer the geographical location of that host. This information may be used to shape follow-on behaviors, including whether the adversary infects the target and/or attempts specific actions. This decision may be employed by malware developers and operators to reduce their risk of attracting the attention of specific law enforcement agencies or prosecution/scrutiny from other entities.(Citation: Malware System Language Check)

There are various sources of data an adversary could use to infer system language, such as system defaults and keyboard layouts. Specific checks will vary based on the target and/or adversary, but may involve behaviors such as [Query Registry](https://attack.mitre.org/techniques/T1012) and calls to [Native API](https://attack.mitre.org/techniques/T1106) functions.(Citation: CrowdStrike Ryuk January 2019) 

For example, on a Windows system adversaries may attempt to infer the language of a system by querying the registry key <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Language</code> or parsing the outputs of Windows API functions <code>GetUserDefaultUILanguage</code>, <code>GetSystemDefaultUILanguage</code>, <code>GetKeyboardLayoutList</code> and <code>GetUserDefaultLangID</code>.(Citation: Darkside Ransomware Cybereason)(Citation: Securelist JSWorm)(Citation: SecureList SynAck Doppelgänging May 2018)

On a macOS or Linux system, adversaries may query <code>locale</code> to retrieve the value of the <code>$LANG</code> environment variable.",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1526,クラウドサービスの探索,Cloud Service Discovery,"攻撃者は、アクセスを取得した後、システム上で実行されているクラウドサービスを列挙しようとする可能性があります。これらの方法は、Platform-as-a-Service（PaaS）からInfrastructure-as-a-Service（IaaS）またはSoftware-as-a-Service（SaaS）までさまざまです。さまざまなクラウドプロバイダー全体に多くのサービスが存在し、継続的インテグレーションと継続的デリバリー（CI/CD）、Lambda関数、Entra IDなどが含まれる場合があります。また、AWS GuardDutyやMicrosoft Defender for Cloudなどのセキュリティサービスや、AWS CloudTrailやGoogle Cloud Audit Logsなどのログ記録サービスも含まれる場合があります。

攻撃者は、環境全体で有効になっているサービスに関する情報を発見しようとする可能性があります。Microsoft Graph APIやAzure Resource Manager APIなどのAzureツールとAPIは、アプリケーション、管理グループ、リソースとポリシー定義、およびIDによってアクセス可能なそれらの関係など、リソースとサービスを列挙できます。(引用: Azure - Resource Manager API)(引用: Azure AD Graph API)

例えば、StormspotterはAzureリソースとサービスのグラフを列挙して構築するためのオープンソースツールであり、Pacuはクラウドサービスを発見するためのいくつかのメソッドをサポートするオープンソースAWSエクスプロイトフレームワークです。(引用: Azure - Stormspotter)(引用: GitHub Pacu)

敵対者は、得られた情報を使用して、列挙されたサービスからのデータや資格情報を標的にしたり、[ツールの無効化または変更](https://attack.mitre.org/techniques/T1562/001)や[クラウドログの無効化または変更](https://attack.mitre.org/techniques/T1562/008)を通じて特定された防御を回避したりするなど、その後の行動を形成する可能性があります。","An adversary may attempt to enumerate the cloud services running on a system after gaining access. These methods can differ from platform-as-a-service (PaaS), to infrastructure-as-a-service (IaaS), or software-as-a-service (SaaS). Many services exist throughout the various cloud providers and can include Continuous Integration and Continuous Delivery (CI/CD), Lambda Functions, Entra ID, etc. They may also include security services, such as AWS GuardDuty and Microsoft Defender for Cloud, and logging services, such as AWS CloudTrail and Google Cloud Audit Logs.

Adversaries may attempt to discover information about the services enabled throughout the environment. Azure tools and APIs, such as the Microsoft Graph API and Azure Resource Manager API, can enumerate resources and services, including applications, management groups, resources and policy definitions, and their relationships that are accessible by an identity.(Citation: Azure - Resource Manager API)(Citation: Azure AD Graph API)

For example, Stormspotter is an open source tool for enumerating and constructing a graph for Azure resources and services, and Pacu is an open source AWS exploitation framework that supports several methods for discovering cloud services.(Citation: Azure - Stormspotter)(Citation: GitHub Pacu)

Adversaries may use the information gained to shape follow-on behaviors, such as targeting data or credentials from enumerated services or evading identified defenses through [Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001) or [Disable or Modify Cloud Logs](https://attack.mitre.org/techniques/T1562/008).",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1018,リモートシステムの探索,Remote System Discovery,"攻撃者は、現在のシステムからの横方向の移動に使用できる可能性のあるネットワーク上のIPアドレス、ホスト名、またはその他の論理識別子によって、他のシステムのリストを取得しようとする可能性があります。これを可能にする機能はリモートアクセスツール内に存在する可能性がありますが、オペレーティングシステムで利用可能なユーティリティ（[Ping](https://attack.mitre.org/software/S0097)、[Net](https://attack.mitre.org/software/S0039)を使用した<code>net view</code>、またはESXiサーバー上の<code>esxcli network diag ping</code>など）も使用できます。

敵対者はまた、環境内のリモートシステムの存在を発見するために、ローカルホストファイル（例：<code>C:\\Windows\\System32\\Drivers\\etc\\hosts</code>または<code>/etc/hosts</code>）からのデータやその他の受動的な手段（ローカル[Arp](https://attack.mitre.org/software/S0099)キャッシュエントリなど）を分析する可能性があります。

攻撃者はまた、ネットワークインフラストラクチャの発見を標的にしたり、ネットワークデバイス上の[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)コマンドを利用してネットワーク内のシステムに関する詳細情報を収集したり（例：<code>show cdp neighbors</code>、<code>show arp</code>）する可能性があります。(引用: US-CERT-TA18-106A)(引用: CISA AR21-126A FIVEHANDS May 2021)","Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  [Ping](https://attack.mitre.org/software/S0097), <code>net view</code> using [Net](https://attack.mitre.org/software/S0039), or, on ESXi servers, `esxcli network diag ping`.

Adversaries may also analyze data from local host files (ex: <code>C:\\Windows\\System32\\Drivers\\etc\\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local [Arp](https://attack.mitre.org/software/S0099) cache entries) in order to discover the presence of remote systems in an environment.

Adversaries may also target discovery of network infrastructure as well as leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands on network devices to gather detailed information about systems within a network (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).(Citation: US-CERT-TA18-106A)(Citation: CISA AR21-126A FIVEHANDS May 2021)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1046,ネットワークサービスの探索,Network Service Discovery,"攻撃者は、リモートホストやローカルネットワークインフラストラクチャデバイスで実行されているサービス（リモートソフトウェアの悪用に対して脆弱な可能性のあるものを含む）のリストを取得しようとする可能性があります。この情報を取得する一般的な方法には、システムに持ち込まれたツールを使用したポートスキャン、脆弱性スキャン、および/またはワードリストスキャンが含まれます。(引用: CISA AR21-126A FIVEHANDS May 2021)

クラウド環境内では、攻撃者は他のクラウドホストで実行されているサービスを発見しようとする可能性があります。さらに、クラウド環境がオンプレミス環境に接続されている場合、攻撃者はクラウド以外のシステムで実行されているサービスも特定できる可能性があります。

macOS環境内では、攻撃者はネイティブのBonjourアプリケーションを使用して、ネットワーク内の他のmacOSホストで実行されているサービスを発見する可能性があります。Bonjour mDNSResponderデーモンは、ホストの登録済みサービスをネットワーク上で自動的に登録およびアドバタイズします。例えば、攻撃者はmDNSクエリ（<code>dns-sd -B _ssh._tcp .</code>など）を使用して、sshサービスをブロードキャストしている他のシステムを見つけることができます。(引用: apple doco bonjour description)(引用: macOS APT Activity Bradley)","Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. Common methods to acquire this information include port, vulnerability, and/or wordlist scans using tools that are brought onto a system.(Citation: CISA AR21-126A FIVEHANDS May 2021)   

Within cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well.

Within macOS environments, adversaries may use the native Bonjour application to discover services running on other macOS hosts within a network. The Bonjour mDNSResponder daemon automatically registers and advertises a host’s registered services on the network. For example, adversaries can use a mDNS query (such as <code>dns-sd -B _ssh._tcp .</code>) to find other systems broadcasting the ssh service.(Citation: apple doco bonjour description)(Citation: macOS APT Activity Bradley)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1518,ソフトウェアの探索,Software Discovery,"攻撃者は、システムまたはクラウド環境にインストールされているソフトウェアおよびソフトウェアバージョンのリストを取得しようとする可能性があります。攻撃者は、自動検出中に[ソフトウェアディスカバリ](https://attack.mitre.org/techniques/T1518)からの情報を使用して、攻撃者がターゲットを完全に感染させるかどうか、および/または特定のアクションを試みるかどうかなど、その後の行動を形成する可能性があります。

そのようなソフトウェアは、構成管理またはセキュリティ上の理由から環境全体に広く展開されている可能性があり、例えば[ソフトウェア展開ツール](https://attack.mitre.org/techniques/T1072)などがあり、攻撃者がデバイスに感染させたり横方向に移動したりするための広範なアクセスを許可する可能性があります。

攻撃者は、存在するセキュリティ対策を把握したり、侵害されたシステムに[権限昇格のための悪用](https://attack.mitre.org/techniques/T1068)に対して脆弱なバージョンのソフトウェアがあるかどうかを判断したりするなど、さまざまな理由でソフトウェアを列挙しようとする可能性があります。","Adversaries may attempt to get a listing of software and software versions that are installed on a system or in a cloud environment. Adversaries may use the information from [Software Discovery](https://attack.mitre.org/techniques/T1518) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Such software may be deployed widely across the environment for configuration management or security reasons, such as [Software Deployment Tools](https://attack.mitre.org/techniques/T1072), and may allow adversaries broad access to infect devices or move laterally.

Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable to [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068).",T1518.001,セキュリティソフトウェアの探索,Security Software Discovery,"攻撃者は、システムまたはクラウド環境にインストールされているセキュリティソフトウェア、構成、防御ツール、センサーのリストを取得しようとする可能性があります。これには、クラウド監視エージェントやウイルス対策ソフトなどが含まれる場合があります。攻撃者は、自動検出中に[セキュリティソフトウェアディスカバリ](https://attack.mitre.org/techniques/T1518/001)からの情報を使用して、攻撃者がターゲットを完全に感染させるかどうか、および/または特定のアクションを試みるかどうかなど、その後の行動を形成する可能性があります。

セキュリティソフトウェア情報を取得するために使用できるコマンドの例としては、[netsh](https://attack.mitre.org/software/S0108)、[Reg](https://attack.mitre.org/software/S0075)を使用した<code>reg query</code>、[cmd](https://attack.mitre.org/software/S0106)を使用した<code>dir</code>、[Tasklist](https://attack.mitre.org/software/S0057)などがありますが、ディスカバリ動作の他のインジケータは、攻撃者が探しているソフトウェアまたはセキュリティシステムの種類に固有である可能性があります。macOSマルウェアがLittleSnitchおよびKnockKnockソフトウェアのチェックを実行するのがより一般的になりつつあります。

敵対者はまた、AWS CloudWatchエージェント、Azure VMエージェント、Google Cloud Monitorエージェントなど、コンピューティングインフラストラクチャにインストールされたクラウドネイティブのセキュリティソフトウェアを発見するために[クラウドAPI](https://attack.mitre.org/techniques/T1059/009)を利用するかもしれない。これらのエージェントはVMからメトリクスやログを収集し、クラウドベースの監視プラットフォームに集約されるかもしれない。","Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as cloud monitoring agents and anti-virus. Adversaries may use the information from [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Example commands that can be used to obtain security software information are [netsh](https://attack.mitre.org/software/S0108), <code>reg query</code> with [Reg](https://attack.mitre.org/software/S0075), <code>dir</code> with [cmd](https://attack.mitre.org/software/S0106), and [Tasklist](https://attack.mitre.org/software/S0057), but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for. It is becoming more common to see macOS malware perform checks for LittleSnitch and KnockKnock software.

Adversaries may also utilize the [Cloud API](https://attack.mitre.org/techniques/T1059/009) to discover cloud-native security software installed on compute infrastructure, such as the AWS CloudWatch agent, Azure VM Agent, and Google Cloud Monitor agent. These agents  may collect  metrics and logs from the VM, which may be centrally aggregated in a cloud-based monitoring platform.",6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1538,クラウドサービスダッシュボード,Cloud Service Dashboard,"攻撃者は、盗まれた認証情報を使用してクラウドサービスダッシュボードGUIを使用し、特定のサービス、リソース、機能など、運用中のクラウド環境から有用な情報を取得する可能性があります。例えば、GCPコマンドセンターを使用して、すべてのアセットを表示したり、潜在的なセキュリティリスクの調査結果を確認したり、パブリックIPアドレスやオープンポートの検索など、追加のクエリを実行したりできます。(引用: Google Command Center Dashboard)

環境の構成によっては、攻撃者はAPIよりもグラフィカルダッシュボードを介してより多くの情報を列挙できる場合があります。これにより、攻撃者は手動でAPIリクエストを行うことなく情報を取得することもできます。","An adversary may use a cloud service dashboard GUI with stolen credentials to gain useful information from an operational cloud environment, such as specific services, resources, and features. For example, the GCP Command Center can be used to view all assets, review findings of potential security risks, and run additional queries, such as finding public IP addresses and open ports.(Citation: Google Command Center Dashboard)

Depending on the configuration of the environment, an adversary may be able to enumerate more information via the graphical dashboard than an API. This also allows the adversary to gain information without manually making any API requests.",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1622,デバッガ回避,Debugger Evasion,"攻撃者は、デバッガを検出して回避するためにさまざまな手段を用いる可能性があります。デバッガは通常、防御側が潜在的なマルウェアペイロードの実行をトレースおよび/または分析するために使用します。(引用: ProcessHacker Github)

デバッガ回避には、デバッグ環境を示すアーティファクトの存在のチェック結果に基づいて動作を変更することが含まれる場合があります。[仮想化/サンドボックス回避](https://attack.mitre.org/techniques/T1497)と同様に、攻撃者がデバッガを検出した場合、マルウェアを変更して被害者から切り離したり、インプラントのコア機能を隠したりする可能性があります。また、セカンダリペイロードまたは追加ペイロードをドロップする前にデバッgaーアーティファクトを検索することもあります。

特定のチェックは、ターゲットおよび/または敵対者によって異なります。Windowsでは、これには<code>IsDebuggerPresent()</code>や<code>NtQueryInformationProcess()</code>などの[ネイティブAPI](https://attack.mitre.org/techniques/T1106)関数呼び出し、またはプロセス環境ブロック（PEB）の<code>BeingDebugged</code>フラグの手動チェックが含まれる場合があります。Linuxでは、これには`/proc/self/status`の<code>TracerPID</code>フィールドのクエリが含まれる場合があり、これはプロセスが動的分析ツールによってトレースされているかどうかを示します。(引用: Cado Security P2PInfect 2023)(引用: Positive Technologies Hellhounds 2023) デバッグアーティファクトの他のチェックでは、ハードウェアブレークポイント、割り込みアセンブリオペコード、時間チェック、または現在のプロセスで例外が発生した場合の測定（存在するデバッガーが潜在的なエラーを「飲み込む」または処理すると仮定）を列挙しようとする場合もあります。(引用: hasherezade debug)(引用: AlKhaser Debug)(引用: vxunderground debug)

マルウェアはまた、構造化例外処理（SEH）を利用して、例外をスローし、プロセスが中断されているかどうかを検出することにより、デバッガーを検出する可能性があります。SEHはハードウェアとソフトウェアの両方の期待値を処理し、デバッグのサポートを含む例外の制御を提供します。デバッガーが存在する場合、プログラムの制御はデバッガーに移り、コードの実行は中断されます。デバッガーが存在しない場合、制御はSEHハンドラーに移り、例外を自動的に処理してプログラムの実行を継続させます。(引用: Apriorit)

攻撃者は、これらのデバッガチェックから学習した情報を自動検出中に使用して、その後の動作を形成する可能性があります。デバッガはまた、プロセスを切り離したり、<code>OutputDebugStringW()</code>などの[ネイティブAPI](https://attack.mitre.org/techniques/T1106)関数呼び出しをループさせることによって生成されるメッセージを介してデバッグログを無意味なデータであふれさせたりすることによって回避できます。(引用: wardle evilquest partii)(引用: Checkpoint Dridex Jan 2021)","Adversaries may employ various means to detect and avoid debuggers. Debuggers are typically used by defenders to trace and/or analyze the execution of potential malware payloads.(Citation: ProcessHacker Github)

Debugger evasion may include changing behaviors based on the results of the checks for the presence of artifacts indicative of a debugged environment. Similar to [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497), if the adversary detects a debugger, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for debugger artifacts before dropping secondary or additional payloads.

Specific checks will vary based on the target and/or adversary. On Windows, this may involve [Native API](https://attack.mitre.org/techniques/T1106) function calls such as <code>IsDebuggerPresent()</code> and <code> NtQueryInformationProcess()</code>, or manually checking the <code>BeingDebugged</code> flag of the Process Environment Block (PEB). On Linux, this may involve querying `/proc/self/status` for the `TracerPID` field, which indicates whether or not the process is being traced by dynamic analysis tools.(Citation: Cado Security P2PInfect 2023)(Citation: Positive Technologies Hellhounds 2023) Other checks for debugging artifacts may also seek to enumerate hardware breakpoints, interrupt assembly opcodes, time checks, or measurements if exceptions are raised in the current process (assuming a present debugger would “swallow” or handle the potential error).(Citation: hasherezade debug)(Citation: AlKhaser Debug)(Citation: vxunderground debug)

Malware may also leverage Structured Exception Handling (SEH) to detect debuggers by throwing an exception and detecting whether the process is suspended. SEH handles both hardware and software expectations, providing control over the exceptions including support for debugging. If a debugger is present, the program’s control will be transferred to the debugger, and the execution of the code will be suspended. If the debugger is not present, control will be transferred to the SEH handler, which will automatically handle the exception and allow the program’s execution to continue.(Citation: Apriorit)

Adversaries may use the information learned from these debugger checks during automated discovery to shape follow-on behaviors. Debuggers can also be evaded by detaching the process or flooding debug logs with meaningless data via messages produced by looping [Native API](https://attack.mitre.org/techniques/T1106) function calls such as <code>OutputDebugStringW()</code>.(Citation: wardle evilquest partii)(Citation: Checkpoint Dridex Jan 2021)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。
TA0007,探索,Discovery,"攻撃者はあなたの環境を把握しようとしています。

ディスカバリーは、攻撃者がシステムおよび内部ネットワークに関する知識を得るために使用する可能性のあるテクニックで構成されます。これらのテクニックは、攻撃者が行動方法を決定する前に環境を観察し、状況を把握するのに役立ちます。また、現在の目的にどのように役立つかを発見するために、エントリーポイントの周囲で何を制御でき、何があるかを探ることもできます。ネイティブのオペレーティングシステムツールは、この侵害後の情報収集の目的でよく使用されます。","The adversary is trying to figure out your environment.

Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what’s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective.",T1124,システム時刻の探索,System Time Discovery,"攻撃者は、ローカルまたはリモートシステムからシステム時刻および/またはタイムゾーン設定を収集する可能性があります。システム時刻は、WindowsのWindows Time ServiceやmacOSの<code>systemsetup</code>などのサービスによって設定および保存されます。(引用: MSDN System Time)(引用: Technet Windows Time Service)(引用: systemsetup mac time) これらの時刻設定は、エンタープライズネットワーク内のシステムとサービス間で同期される場合もあり、通常はドメイン内のネットワークタイムサーバーで実行されます。(引用: Mac Time Sync)(引用: linux system time)

システム時刻情報は、Windowsで<code>net time \\\\hostname</code>を実行してリモートシステムのシステム時刻を収集するなど、さまざまな方法で収集できます。被害者のタイムゾーンは、現在のシステム時刻から推測したり、<code>w32tm /tz</code>を使用して収集したりすることもできます。(引用: Technet Windows Time Service) さらに、攻撃者は<code>GetTickCount()</code>などの関数を使用してデバイスの稼働時間を検出し、システムの起動からの経過時間を確認できます。(引用: Virtualization/Sandbox Evasion)

ネットワークデバイスでは、<code>show clock detail</code>などの[ネットワークデバイスCLI](https://attack.mitre.org/techniques/T1059/008)コマンドを使用して、現在の時刻設定を確認できます。(引用: show_clock_detail_cisco_cmd) ESXiサーバーでは、同じ目的で<code>esxcli system clock get</code>を使用できます。

さらに、<code>time()</code>などのシステムコールが、Linuxデバイスで現在の時刻を収集するために使用されています。(引用: MAGNET GOBLIN) macOSシステムでは、攻撃者は<code>systemsetup -gettimezone</code>や<code>timeIntervalSinceNow</code>などのコマンドを使用して、現在のタイムゾーン情報や現在の日時を収集する可能性があります。(引用: System Information Discovery Technique)(引用: ESET DazzleSpy Jan 2022)

この情報は、[スケジュールされたタスク/ジョブ](https://attack.mitre.org/techniques/T1053)でファイルを実行したり(引用: RSA EU12 They're Inside)、タイムゾーンに基づいて地域情報を発見して被害者のターゲティングを支援したり(つまり[システムロケーションディスカバリ](https://attack.mitre.org/techniques/T1614))するなど、他のテクニックを実行するのに役立つ可能性があります。攻撃者はまた、タイムボムの一部として、または指定された日時まで実行を遅らせるために、システム時刻の知識を使用する可能性があります。(引用: AnyRun TimeBomb)","An adversary may gather the system time and/or time zone settings from a local or remote system. The system time is set and stored by services, such as the Windows Time Service on Windows or <code>systemsetup</code> on macOS.(Citation: MSDN System Time)(Citation: Technet Windows Time Service)(Citation: systemsetup mac time) These time settings may also be synchronized between systems and services in an enterprise network, typically accomplished with a network time server within a domain.(Citation: Mac Time Sync)(Citation: linux system time)

System time information may be gathered in a number of ways, such as with [Net](https://attack.mitre.org/software/S0039) on Windows by performing <code>net time \\\\hostname</code> to gather the system time on a remote system. The victim's time zone may also be inferred from the current system time or gathered by using <code>w32tm /tz</code>.(Citation: Technet Windows Time Service) In addition, adversaries can discover device uptime through functions such as <code>GetTickCount()</code> to determine how long it has been since the system booted up.(Citation: Virtualization/Sandbox Evasion)

On network devices, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `show clock detail` can be used to see the current time configuration.(Citation: show_clock_detail_cisco_cmd) On ESXi servers, `esxcli system clock get` can be used for the same purpose.

In addition, system calls – such as <code>time()</code> – have been used to collect the current time on Linux devices.(Citation: MAGNET GOBLIN) On macOS systems, adversaries may use commands such as <code>systemsetup -gettimezone</code> or <code>timeIntervalSinceNow</code> to gather current time zone information or current date and time.(Citation: System Information Discovery Technique)(Citation: ESET DazzleSpy Jan 2022)

This information could be useful for performing other techniques, such as executing a file with a [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053)(Citation: RSA EU12 They're Inside), or to discover locality information based on time zone to assist in victim targeting (i.e. [System Location Discovery](https://attack.mitre.org/techniques/T1614)). Adversaries may also use knowledge of system time as part of a time bomb, or delaying execution until a specified date/time.(Citation: AnyRun TimeBomb)",,,,,,6,Command and Control (C2),Attacker establishes a communication channel with the compromised system to remotely control it exfiltrate data or issue further commands.,コマンド＆コントロール (C2),攻撃者は、侵害されたシステムとの通信チャネルを確立し、リモートで制御したり、データを窃取したり、さらなるコマンドを発行したりします。,,,,,,標的システムやネットワーク環境を調査する活動。C2確立後に内部偵察を行い、次の行動計画を立てるために実施される。